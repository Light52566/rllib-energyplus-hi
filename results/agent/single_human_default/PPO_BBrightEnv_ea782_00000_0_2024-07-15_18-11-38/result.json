{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.50623936949547}, "default_policy": {"total_loss": 0.50623936949547, "policy_loss": 0.04876328870198125, "vf_loss": 6.0877756633356945, "vf_loss_unclipped": 19.232627644022898, "vf_explained_var": 2.3243206142108325e-05, "entropy": 2.0878338313687332, "mean_kl_loss": 1.3219943421062277, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.9080393304338, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 18189.363, "sample_time_ms": 13305.757, "synch_weights_time_ms": 2.524}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "ea782_00000", "date": "2024-07-15_18-12-11", "timestamp": 1721059931, "time_this_iter_s": 18.191462755203247, "time_total_s": 18.191462755203247, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18.191462755203247, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.123076923076923, "ram_util_percent": 73.61538461538463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04948438295939647}, "default_policy": {"total_loss": 0.04948438295939647, "policy_loss": -0.0007304816332055942, "vf_loss": 4.180089237847562, "vf_loss_unclipped": 8.410291995829356, "vf_explained_var": 6.468241402843613e-05, "entropy": 1.1972016065613802, "mean_kl_loss": 0.018697719808234228, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 259.5274884675572, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 16800.972, "sample_time_ms": 12270.313, "synch_weights_time_ms": 2.374}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "ea782_00000", "date": "2024-07-15_18-12-27", "timestamp": 1721059947, "time_this_iter_s": 15.414932012557983, "time_total_s": 33.60639476776123, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.60639476776123, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.186363636363637, "ram_util_percent": 75.69545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06205265053626356}, "default_policy": {"total_loss": 0.06205265053626356, "policy_loss": 0.01918415727961594, "vf_loss": 3.010309736738835, "vf_loss_unclipped": 3.4956643102265623, "vf_explained_var": 1.4544041680374633e-06, "entropy": 1.1629001819757, "mean_kl_loss": 0.02836754823610289, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.1853957405928, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 16063.529, "sample_time_ms": 11699.573, "synch_weights_time_ms": 2.278}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "ea782_00000", "date": "2024-07-15_18-12-41", "timestamp": 1721059961, "time_this_iter_s": 14.590933084487915, "time_total_s": 48.197327852249146, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.197327852249146, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.79047619047619, "ram_util_percent": 75.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.036028997582777625}, "default_policy": {"total_loss": 0.036028997582777625, "policy_loss": 0.0031205091321630392, "vf_loss": 2.540347561399057, "vf_loss_unclipped": 2.831281913877296, "vf_explained_var": 3.0276617770001834e-05, "entropy": 1.1125266415986426, "mean_kl_loss": 0.01111854358623338, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.90511568260985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15808.38, "sample_time_ms": 11504.219, "synch_weights_time_ms": 2.354}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "ea782_00000", "date": "2024-07-15_18-12-56", "timestamp": 1721059976, "time_this_iter_s": 15.0451180934906, "time_total_s": 63.242445945739746, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.242445945739746, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 10.172727272727274, "ram_util_percent": 75.24545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04046591210984754}, "default_policy": {"total_loss": 0.04046591210984754, "policy_loss": -0.0023634656022654284, "vf_loss": 3.137813679000208, "vf_loss_unclipped": 5.436633259312177, "vf_explained_var": 4.4530134465394496e-05, "entropy": 1.0431364704169699, "mean_kl_loss": 0.016964805898223585, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 257.2605831381529, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 15756.386, "sample_time_ms": 11431.853, "synch_weights_time_ms": 2.329}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "ea782_00000", "date": "2024-07-15_18-13-12", "timestamp": 1721059992, "time_this_iter_s": 15.551355838775635, "time_total_s": 78.79380178451538, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 78.79380178451538, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.895454545454545, "ram_util_percent": 75.50454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.056941240733521165}, "default_policy": {"total_loss": 0.056941240733521165, "policy_loss": 0.010752655695309676, "vf_loss": 2.5279420342907977, "vf_loss_unclipped": 2.9957211516432163, "vf_explained_var": 2.404837720175542e-06, "entropy": 1.0854415010287564, "mean_kl_loss": 0.030976538352244076, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.58561993659293, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 15567.09, "sample_time_ms": 11309.346, "synch_weights_time_ms": 2.358}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "ea782_00000", "date": "2024-07-15_18-13-27", "timestamp": 1721060007, "time_this_iter_s": 14.622897148132324, "time_total_s": 93.4166989326477, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.4166989326477, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.419999999999998, "ram_util_percent": 75.71}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03520875203429159}, "default_policy": {"total_loss": 0.03520875203429159, "policy_loss": 0.0015211232882271061, "vf_loss": 2.1579588295173036, "vf_loss_unclipped": 2.3217200629873824, "vf_explained_var": -9.494803861768516e-07, "entropy": 1.0336793804727893, "mean_kl_loss": 0.011958561497952675, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.8798005617724, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15516.941, "sample_time_ms": 11279.727, "synch_weights_time_ms": 2.315}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "ea782_00000", "date": "2024-07-15_18-13-42", "timestamp": 1721060022, "time_this_iter_s": 15.21868371963501, "time_total_s": 108.63538265228271, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 108.63538265228271, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 75.45909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07698674367736778}, "default_policy": {"total_loss": 0.07698674367736778, "policy_loss": 0.0001180828623433929, "vf_loss": 6.066733919354136, "vf_loss_unclipped": 14.8042815796602, "vf_explained_var": -8.912101737471786e-07, "entropy": 1.1183059412533287, "mean_kl_loss": 0.01600130434506816, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.3010687555553, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15447.87, "sample_time_ms": 11237.577, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "ea782_00000", "date": "2024-07-15_18-13-57", "timestamp": 1721060037, "time_this_iter_s": 14.966719150543213, "time_total_s": 123.60210180282593, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 123.60210180282593, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.519047619047617, "ram_util_percent": 75.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08587371453102718}, "default_policy": {"total_loss": 0.08587371453102718, "policy_loss": 0.00626307946623865, "vf_loss": 6.282350450055177, "vf_loss_unclipped": 22.979945957660675, "vf_explained_var": -1.1623541175175322e-06, "entropy": 1.2137291059056834, "mean_kl_loss": 0.016579882242840464, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.4955350126687, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 15380.608, "sample_time_ms": 11208.919, "synch_weights_time_ms": 2.295}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 9, "trial_id": "ea782_00000", "date": "2024-07-15_18-14-12", "timestamp": 1721060052, "time_this_iter_s": 14.844927072525024, "time_total_s": 138.44702887535095, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 138.44702887535095, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.027272727272727, "ram_util_percent": 75.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07547586697088217}, "default_policy": {"total_loss": 0.07547586697088217, "policy_loss": -0.001967282804436108, "vf_loss": 6.046842361055711, "vf_loss_unclipped": 14.822109428550135, "vf_explained_var": -1.3093958531361398e-06, "entropy": 1.1569928512263146, "mean_kl_loss": 0.016765159973085038, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 279.1300305939345, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15275.569, "sample_time_ms": 11132.04, "synch_weights_time_ms": 2.313}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 10, "trial_id": "ea782_00000", "date": "2024-07-15_18-14-26", "timestamp": 1721060066, "time_this_iter_s": 14.332279682159424, "time_total_s": 152.77930855751038, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.77930855751038, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 75.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1006375975839333}, "default_policy": {"total_loss": 0.1006375975839333, "policy_loss": 0.005201846448533825, "vf_loss": 6.43375818078706, "vf_loss_unclipped": 15.509232520421685, "vf_explained_var": -8.145120860671184e-07, "entropy": 1.1957788070254742, "mean_kl_loss": 0.030714235825399963, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.03486294850967, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14885.023, "sample_time_ms": 10848.203, "synch_weights_time_ms": 2.286}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 11, "trial_id": "ea782_00000", "date": "2024-07-15_18-14-40", "timestamp": 1721060080, "time_this_iter_s": 14.286044359207153, "time_total_s": 167.06535291671753, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 167.06535291671753, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 8.355, "ram_util_percent": 75.43000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07154523218914406}, "default_policy": {"total_loss": 0.07154523218914406, "policy_loss": 0.0040365733466407, "vf_loss": 4.956489006434676, "vf_loss_unclipped": 8.311680825502634, "vf_explained_var": -3.5455231981745153e-06, "entropy": 1.117563952642209, "mean_kl_loss": 0.011814826952806338, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 283.86844307785975, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14752.866, "sample_time_ms": 10755.033, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 12, "trial_id": "ea782_00000", "date": "2024-07-15_18-14-55", "timestamp": 1721060095, "time_this_iter_s": 14.093424797058105, "time_total_s": 181.15877771377563, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.15877771377563, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 8.58, "ram_util_percent": 75.14500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03941750940062535}, "default_policy": {"total_loss": 0.03941750940062535, "policy_loss": 0.0011901867671260066, "vf_loss": 2.6183867430381937, "vf_loss_unclipped": 3.254916180171438, "vf_explained_var": 1.7188759500792287e-06, "entropy": 1.0502646977840455, "mean_kl_loss": 0.007929849725272553, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 285.3878407735641, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14695.6, "sample_time_ms": 10717.688, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 13, "trial_id": "ea782_00000", "date": "2024-07-15_18-15-09", "timestamp": 1721060109, "time_this_iter_s": 14.017866611480713, "time_total_s": 195.17664432525635, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 195.17664432525635, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 8.669999999999998, "ram_util_percent": 75.15499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03230898925063532}, "default_policy": {"total_loss": 0.03230898925063532, "policy_loss": -0.0003027805144082445, "vf_loss": 2.532264794971643, "vf_loss_unclipped": 3.8157191912947432, "vf_explained_var": 1.7974803696817427e-06, "entropy": 1.1325559396225253, "mean_kl_loss": 0.004799424198684533, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 285.93888700390147, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14590.204, "sample_time_ms": 10642.825, "synch_weights_time_ms": 2.257}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 14, "trial_id": "ea782_00000", "date": "2024-07-15_18-15-23", "timestamp": 1721060123, "time_this_iter_s": 13.991516351699829, "time_total_s": 209.16816067695618, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 209.16816067695618, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 8.83, "ram_util_percent": 75.165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06802259387943878}, "default_policy": {"total_loss": 0.06802259387943878, "policy_loss": 0.018553821441493056, "vf_loss": 1.9821485940899168, "vf_loss_unclipped": 2.101466544560278, "vf_explained_var": 0.0001911880619236147, "entropy": 1.1800778070365443, "mean_kl_loss": 0.03904169488493835, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.139062523841858}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 290.34003698625213, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14413.056, "sample_time_ms": 10528.529, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 15, "trial_id": "ea782_00000", "date": "2024-07-15_18-15-36", "timestamp": 1721060136, "time_this_iter_s": 13.779256582260132, "time_total_s": 222.9474172592163, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.9474172592163, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.705, "ram_util_percent": 75.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.053320359846235496}, "default_policy": {"total_loss": 0.053320359846235496, "policy_loss": 0.007661341446767579, "vf_loss": 2.8118672265109224, "vf_loss_unclipped": 6.791163542091465, "vf_explained_var": -9.57105713866667e-07, "entropy": 1.0229512756821444, "mean_kl_loss": 0.015398935013645256, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.139062523841858}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 284.57933670205887, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14356.575, "sample_time_ms": 10485.278, "synch_weights_time_ms": 2.287}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 16, "trial_id": "ea782_00000", "date": "2024-07-15_18-15-50", "timestamp": 1721060150, "time_this_iter_s": 14.058147668838501, "time_total_s": 237.0055649280548, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.0055649280548, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.515, "ram_util_percent": 75.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09891487723702926}, "default_policy": {"total_loss": 0.09891487723702926, "policy_loss": 0.006913396262023638, "vf_loss": 6.666657547960912, "vf_loss_unclipped": 24.96343122286075, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.1570917292952791, "mean_kl_loss": 0.022241893087881482, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7085938453674316}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}}, "episode_reward_max": -10756.0, "episode_reward_min": -10756.0, "episode_reward_mean": -10756.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0], "episode_lengths": [35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4606542512842763, "mean_inference_ms": 1.176074578932188, "mean_action_processing_ms": 0.12408037695075827, "mean_env_wait_ms": 1.0276525928750244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005984306335449219, "StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.2815723419189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 281.58573982373196, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14255.493, "sample_time_ms": 10414.387, "synch_weights_time_ms": 2.309}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 17, "trial_id": "ea782_00000", "date": "2024-07-15_18-16-05", "timestamp": 1721060165, "time_this_iter_s": 14.207072496414185, "time_total_s": 251.212637424469, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 251.212637424469, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.33, "ram_util_percent": 75.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06462252746968628}, "default_policy": {"total_loss": 0.06462252746968628, "policy_loss": -0.0012149848664469367, "vf_loss": 5.794749369118005, "vf_loss_unclipped": 16.815508296748977, "vf_explained_var": -9.57105713866667e-07, "entropy": 1.238110867771767, "mean_kl_loss": 0.004617844685381792, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8542969226837158}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.8541097259166, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14252.404, "sample_time_ms": 10435.463, "synch_weights_time_ms": 2.317}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 18, "trial_id": "ea782_00000", "date": "2024-07-15_18-16-20", "timestamp": 1721060180, "time_this_iter_s": 14.936632633209229, "time_total_s": 266.1492700576782, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 266.1492700576782, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 8.513636363636365, "ram_util_percent": 75.32272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0750549555962671}, "default_policy": {"total_loss": 0.0750549555962671, "policy_loss": -0.00011194536863550194, "vf_loss": 6.079450207605545, "vf_loss_unclipped": 14.17746280289408, "vf_explained_var": -9.553264707390433e-07, "entropy": 1.2722704474097375, "mean_kl_loss": 0.016823655539171877, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8542969226837158}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.91402284328893, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14212.641, "sample_time_ms": 10397.302, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "ea782_00000", "date": "2024-07-15_18-16-34", "timestamp": 1721060194, "time_this_iter_s": 14.44740343093872, "time_total_s": 280.59667348861694, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 280.59667348861694, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.665, "ram_util_percent": 75.39500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0848153469307638}, "default_policy": {"total_loss": 0.0848153469307638, "policy_loss": 0.009011781925130993, "vf_loss": 5.341840861448601, "vf_loss_unclipped": 9.144028951110108, "vf_explained_var": -9.577411578408183e-07, "entropy": 1.270856995826591, "mean_kl_loss": 0.02620301757988835, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.31282554301697, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14237.806, "sample_time_ms": 10432.713, "synch_weights_time_ms": 2.252}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "ea782_00000", "date": "2024-07-15_18-16-49", "timestamp": 1721060209, "time_this_iter_s": 14.583983659744263, "time_total_s": 295.1806571483612, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 295.1806571483612, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.880952380952381, "ram_util_percent": 75.49047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05249315824186894}, "default_policy": {"total_loss": 0.05249315824186894, "policy_loss": -0.0005547625642182476, "vf_loss": 3.3593086463683197, "vf_loss_unclipped": 5.145498024947099, "vf_explained_var": -9.540555827907407e-07, "entropy": 1.3276725734220638, "mean_kl_loss": 0.01518194878836264, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.7146139386948, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14297.98, "sample_time_ms": 10449.858, "synch_weights_time_ms": 2.291}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "ea782_00000", "date": "2024-07-15_18-17-04", "timestamp": 1721060224, "time_this_iter_s": 14.887685537338257, "time_total_s": 310.06834268569946, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 310.06834268569946, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.595238095238093, "ram_util_percent": 75.44761904761907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03424239127503545}, "default_policy": {"total_loss": 0.03424239127503545, "policy_loss": 0.0012781627566567553, "vf_loss": 2.249087427979085, "vf_loss_unclipped": 3.4482603822944005, "vf_explained_var": -9.538014052010803e-07, "entropy": 1.2845422155313146, "mean_kl_loss": 0.008173079599161663, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.1564655777869, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14364.039, "sample_time_ms": 10508.666, "synch_weights_time_ms": 2.378}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "ea782_00000", "date": "2024-07-15_18-17-18", "timestamp": 1721060238, "time_this_iter_s": 14.753315687179565, "time_total_s": 324.821658372879, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 324.821658372879, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 9.352380952380953, "ram_util_percent": 75.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03773758113771471}, "default_policy": {"total_loss": 0.03773758113771471, "policy_loss": 0.006245525052417506, "vf_loss": 1.8327896564817632, "vf_loss_unclipped": 2.360272929580735, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.201149883300765, "mean_kl_loss": 0.01027290168271713, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.147104921718, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14437.651, "sample_time_ms": 10515.036, "synch_weights_time_ms": 2.517}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "ea782_00000", "date": "2024-07-15_18-17-33", "timestamp": 1721060253, "time_this_iter_s": 14.754852294921875, "time_total_s": 339.5765106678009, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 339.5765106678009, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 9.033333333333333, "ram_util_percent": 75.09047619047621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.043924790123717854}, "default_policy": {"total_loss": 0.043924790123717854, "policy_loss": 0.0034835553154158694, "vf_loss": 1.9953626664653261, "vf_loss_unclipped": 2.143413157573641, "vf_explained_var": -9.538014052010803e-07, "entropy": 1.178246051644974, "mean_kl_loss": 0.015987892489142324, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.64131024208456, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14511.281, "sample_time_ms": 10576.346, "synch_weights_time_ms": 2.513}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "ea782_00000", "date": "2024-07-15_18-17-48", "timestamp": 1721060268, "time_this_iter_s": 14.727813720703125, "time_total_s": 354.304324388504, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 354.304324388504, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 9.566666666666666, "ram_util_percent": 75.30476190476193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.051606565384245885}, "default_policy": {"total_loss": 0.051606565384245885, "policy_loss": 0.0036840200809432244, "vf_loss": 3.32065986805379, "vf_loss_unclipped": 6.7348692718980665, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.2771610468943744, "mean_kl_loss": 0.011483869161628017, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 254.7310246884736, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14703.87, "sample_time_ms": 10711.326, "synch_weights_time_ms": 2.525}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "ea782_00000", "date": "2024-07-15_18-18-04", "timestamp": 1721060284, "time_this_iter_s": 15.70485234260559, "time_total_s": 370.0091767311096, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.0091767311096, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 9.42727272727273, "ram_util_percent": 75.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09600437612040465}, "default_policy": {"total_loss": 0.09600437612040465, "policy_loss": 0.004585631572004003, "vf_loss": 6.807657291004652, "vf_loss_unclipped": 22.642771765875665, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.227641487235962, "mean_kl_loss": 0.018215500718228358, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11370.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0], "episode_lengths": [35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4579058582307326, "mean_inference_ms": 1.1610396018948763, "mean_action_processing_ms": 0.12195328465911964, "mean_env_wait_ms": 0.995659029350215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006890296936035156, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.3181338310241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 257.8172861337331, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 14849.773, "sample_time_ms": 10814.187, "synch_weights_time_ms": 2.454}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "ea782_00000", "date": "2024-07-15_18-18-19", "timestamp": 1721060299, "time_this_iter_s": 15.517058610916138, "time_total_s": 385.52623534202576, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 385.52623534202576, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 9.33913043478261, "ram_util_percent": 75.61304347826086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08875835930103504}, "default_policy": {"total_loss": 0.08875835930103504, "policy_loss": 0.0064960447282020025, "vf_loss": 5.895367283175495, "vf_loss_unclipped": 18.425961514907097, "vf_explained_var": -9.574869802511577e-07, "entropy": 1.3574318934096965, "mean_kl_loss": 0.018189338851983334, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.5461075916628, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 14941.27, "sample_time_ms": 10846.806, "synch_weights_time_ms": 2.488}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 27, "trial_id": "ea782_00000", "date": "2024-07-15_18-18-34", "timestamp": 1721060314, "time_this_iter_s": 15.122740983963013, "time_total_s": 400.64897632598877, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 400.64897632598877, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.890476190476193, "ram_util_percent": 75.61904761904759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09027208027634412}, "default_policy": {"total_loss": 0.09027208027634412, "policy_loss": 0.00608689072596501, "vf_loss": 6.299913903035081, "vf_loss_unclipped": 15.148574179169465, "vf_explained_var": -9.558348259183644e-07, "entropy": 1.3476200296934733, "mean_kl_loss": 0.01653292879943417, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.0238955892733, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 14912.992, "sample_time_ms": 10817.085, "synch_weights_time_ms": 2.514}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 28, "trial_id": "ea782_00000", "date": "2024-07-15_18-18-49", "timestamp": 1721060329, "time_this_iter_s": 14.652836561203003, "time_total_s": 415.3018128871918, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 415.3018128871918, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.628571428571428, "ram_util_percent": 75.62380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07706575109355294}, "default_policy": {"total_loss": 0.07706575109355294, "policy_loss": 0.0033424031009266116, "vf_loss": 5.725903725255527, "vf_loss_unclipped": 13.40693476923239, "vf_explained_var": -9.548181155597222e-07, "entropy": 1.2974008809783057, "mean_kl_loss": 0.012848235807609127, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.23417169647314, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 14943.241, "sample_time_ms": 10834.03, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 29, "trial_id": "ea782_00000", "date": "2024-07-15_18-19-04", "timestamp": 1721060344, "time_this_iter_s": 14.750075340270996, "time_total_s": 430.05188822746277, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 430.05188822746277, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.957142857142859, "ram_util_percent": 75.46190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.053301998494026157}, "default_policy": {"total_loss": 0.053301998494026157, "policy_loss": 0.00574806033184867, "vf_loss": 2.4928079677670243, "vf_loss_unclipped": 4.185887260032869, "vf_explained_var": -9.558348259183644e-07, "entropy": 1.1861227368240925, "mean_kl_loss": 0.017656513473679518, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.9257310771177, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 14966.941, "sample_time_ms": 10820.598, "synch_weights_time_ms": 2.515}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 30, "trial_id": "ea782_00000", "date": "2024-07-15_18-19-19", "timestamp": 1721060359, "time_this_iter_s": 14.821418046951294, "time_total_s": 444.87330627441406, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 444.87330627441406, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.995238095238095, "ram_util_percent": 75.38095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04917658832364046}, "default_policy": {"total_loss": 0.04917658832364046, "policy_loss": 0.007303787961796816, "vf_loss": 2.4554965905289152, "vf_loss_unclipped": 3.5478430246747634, "vf_explained_var": -9.534201388165895e-07, "entropy": 1.1812995752927338, "mean_kl_loss": 0.013514301347173515, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.34937754149604, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 14931.073, "sample_time_ms": 10815.852, "synch_weights_time_ms": 2.457}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 31, "trial_id": "ea782_00000", "date": "2024-07-15_18-19-33", "timestamp": 1721060373, "time_this_iter_s": 14.529423475265503, "time_total_s": 459.40272974967957, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 459.40272974967957, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.3, "ram_util_percent": 75.43809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04493632849289982}, "default_policy": {"total_loss": 0.04493632849289982, "policy_loss": 0.0022124643745357548, "vf_loss": 2.9031223243614757, "vf_loss_unclipped": 3.9456656044607223, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.387157471703568, "mean_kl_loss": 0.010685311556150363, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.9336998176435, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 14954.41, "sample_time_ms": 10820.887, "synch_weights_time_ms": 2.367}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 32, "trial_id": "ea782_00000", "date": "2024-07-15_18-19-48", "timestamp": 1721060388, "time_this_iter_s": 14.98749041557312, "time_total_s": 474.3902201652527, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 474.3902201652527, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 8.523809523809524, "ram_util_percent": 75.56666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.057346751354932626}, "default_policy": {"total_loss": 0.057346751354932626, "policy_loss": 0.009808866049734943, "vf_loss": 2.4956095013410042, "vf_loss_unclipped": 3.1200532247262722, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.4483732145224044, "mean_kl_loss": 0.017622128090996697, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 283.1231990089651, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 14892.009, "sample_time_ms": 10829.116, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 33, "trial_id": "ea782_00000", "date": "2024-07-15_18-20-02", "timestamp": 1721060402, "time_this_iter_s": 14.130410432815552, "time_total_s": 488.52063059806824, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 488.52063059806824, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.565000000000001, "ram_util_percent": 75.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06067868097147136}, "default_policy": {"total_loss": 0.06067868097147136, "policy_loss": 0.002689988632350842, "vf_loss": 4.60013073638304, "vf_loss_unclipped": 8.56134258728546, "vf_explained_var": -9.582495130201392e-07, "entropy": 1.3631684393770913, "mean_kl_loss": 0.009354582098724721, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.2727931123777, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 14846.659, "sample_time_ms": 10798.234, "synch_weights_time_ms": 2.274}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 34, "trial_id": "ea782_00000", "date": "2024-07-15_18-20-17", "timestamp": 1721060417, "time_this_iter_s": 14.27378797531128, "time_total_s": 502.7944185733795, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.7944185733795, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 8.357142857142858, "ram_util_percent": 75.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08328358059042076}, "default_policy": {"total_loss": 0.08328358059042076, "policy_loss": 0.005206120128967742, "vf_loss": 5.335003521269573, "vf_loss_unclipped": 11.542188893503218, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.296291541697374, "mean_kl_loss": 0.01929651090300886, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11250.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0], "episode_lengths": [35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775608428698117, "mean_inference_ms": 1.1591037472273371, "mean_action_processing_ms": 0.1216918208769406, "mean_env_wait_ms": 0.9812405503891006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062147776285807295, "StateBufferConnector_ms": 0.0035365422566731772, "ViewRequirementAgentConnector_ms": 0.3210624059041341}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.0650145775661, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 14704.615, "sample_time_ms": 10711.602, "synch_weights_time_ms": 2.241}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 35, "trial_id": "ea782_00000", "date": "2024-07-15_18-20-31", "timestamp": 1721060431, "time_this_iter_s": 14.28470754623413, "time_total_s": 517.0791261196136, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 517.0791261196136, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.325000000000001, "ram_util_percent": 75.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07022672610482507}, "default_policy": {"total_loss": 0.07022672610482507, "policy_loss": 0.0010541446337194395, "vf_loss": 5.681414607999676, "vf_loss_unclipped": 12.345619730349544, "vf_explained_var": -9.548181155597222e-07, "entropy": 1.2483356324340236, "mean_kl_loss": 0.009644137171081835, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.8911664518218, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14613.563, "sample_time_ms": 10662.879, "synch_weights_time_ms": 2.246}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 36, "trial_id": "ea782_00000", "date": "2024-07-15_18-20-46", "timestamp": 1721060446, "time_this_iter_s": 14.60695219039917, "time_total_s": 531.6860783100128, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 531.6860783100128, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.242857142857144, "ram_util_percent": 75.63809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05350888330938179}, "default_policy": {"total_loss": 0.05350888330938179, "policy_loss": 0.00022917248056466774, "vf_loss": 3.551052945826862, "vf_loss_unclipped": 5.997896850553911, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.1988960921383107, "mean_kl_loss": 0.013866518501102723, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 277.8386816880782, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 14541.223, "sample_time_ms": 10653.06, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "ea782_00000", "date": "2024-07-15_18-21-00", "timestamp": 1721060460, "time_this_iter_s": 14.399338722229004, "time_total_s": 546.0854170322418, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 546.0854170322418, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 8.225, "ram_util_percent": 75.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04932075860236944}, "default_policy": {"total_loss": 0.04932075860236944, "policy_loss": 0.006998640526808909, "vf_loss": 2.6044091166082475, "vf_loss_unclipped": 3.223382149360327, "vf_explained_var": -9.55199381944213e-07, "entropy": 1.175104998512817, "mean_kl_loss": 0.01270286794030182, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.492612944506, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 14512.455, "sample_time_ms": 10625.668, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "ea782_00000", "date": "2024-07-15_18-21-14", "timestamp": 1721060474, "time_this_iter_s": 14.365285158157349, "time_total_s": 560.4507021903992, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 560.4507021903992, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 8.347619047619048, "ram_util_percent": 75.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07306593280337227}, "default_policy": {"total_loss": 0.07306593280337227, "policy_loss": 0.00466509861772312, "vf_loss": 4.9343257717994735, "vf_loss_unclipped": 8.408154996600487, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.102413691945676, "mean_kl_loss": 0.014871939327151737, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.46474472089375, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 14474.162, "sample_time_ms": 10611.449, "synch_weights_time_ms": 2.209}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "ea782_00000", "date": "2024-07-15_18-21-29", "timestamp": 1721060489, "time_this_iter_s": 14.366755247116089, "time_total_s": 574.8174574375153, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 574.8174574375153, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 8.479999999999999, "ram_util_percent": 75.39500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06698708483047768}, "default_policy": {"total_loss": 0.06698708483047768, "policy_loss": 4.309836749249557e-05, "vf_loss": 5.302330636647719, "vf_loss_unclipped": 12.256176324414293, "vf_explained_var": -9.549452043545526e-07, "entropy": 1.2346996346008041, "mean_kl_loss": 0.010863266151293174, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.67344082525676, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14443.265, "sample_time_ms": 10617.398, "synch_weights_time_ms": 2.167}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "ea782_00000", "date": "2024-07-15_18-21-43", "timestamp": 1721060503, "time_this_iter_s": 14.512578010559082, "time_total_s": 589.3300354480743, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 589.3300354480743, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.014285714285714, "ram_util_percent": 75.34761904761906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05861991168911269}, "default_policy": {"total_loss": 0.05861991168911269, "policy_loss": 7.3970266447059e-05, "vf_loss": 4.431300738727106, "vf_loss_unclipped": 6.68454347363413, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.1747339982976284, "mean_kl_loss": 0.011106939814129803, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.55822424599546, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 14416.294, "sample_time_ms": 10606.284, "synch_weights_time_ms": 2.165}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "ea782_00000", "date": "2024-07-15_18-21-58", "timestamp": 1721060518, "time_this_iter_s": 14.259950160980225, "time_total_s": 603.5899856090546, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 603.5899856090546, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.58, "ram_util_percent": 75.39000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.052694055810769296}, "default_policy": {"total_loss": 0.052694055810769296, "policy_loss": 0.004532038312611867, "vf_loss": 3.12117656754024, "vf_loss_unclipped": 4.352384474231744, "vf_explained_var": -9.534201388165895e-07, "entropy": 1.139683976102231, "mean_kl_loss": 0.013227451273100153, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.4889607475732, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 14369.758, "sample_time_ms": 10580.484, "synch_weights_time_ms": 2.189}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "ea782_00000", "date": "2024-07-15_18-22-12", "timestamp": 1721060532, "time_this_iter_s": 14.52163577079773, "time_total_s": 618.1116213798523, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 618.1116213798523, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.50952380952381, "ram_util_percent": 75.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06369976141650889}, "default_policy": {"total_loss": 0.06369976141650889, "policy_loss": 0.011486345510890108, "vf_loss": 2.6702349102700444, "vf_loss_unclipped": 3.210845157345221, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.0536064867144708, "mean_kl_loss": 0.01990804298171974, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2814453840255737}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11378.75, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0], "episode_lengths": [35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576269139638407, "mean_inference_ms": 1.1571104520898077, "mean_action_processing_ms": 0.12145098579050406, "mean_env_wait_ms": 0.97300711025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005829334259033203, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.30906200408935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.6411032537594, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 14392.485, "sample_time_ms": 10607.249, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "ea782_00000", "date": "2024-07-15_18-22-27", "timestamp": 1721060547, "time_this_iter_s": 14.357619524002075, "time_total_s": 632.4692409038544, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 632.4692409038544, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.709999999999999, "ram_util_percent": 75.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08061896141783309}, "default_policy": {"total_loss": 0.08061896141783309, "policy_loss": 0.007889263347776206, "vf_loss": 4.685268198249182, "vf_loss_unclipped": 7.720258218901498, "vf_explained_var": -9.559619147131947e-07, "entropy": 1.220356969754579, "mean_kl_loss": 0.020193616809381264, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 272.93989443737695, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14430.828, "sample_time_ms": 10649.028, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 44, "trial_id": "ea782_00000", "date": "2024-07-15_18-22-41", "timestamp": 1721060561, "time_this_iter_s": 14.657278299331665, "time_total_s": 647.126519203186, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.126519203186, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 8.685714285714287, "ram_util_percent": 75.45238095238098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0537357866150468}, "default_policy": {"total_loss": 0.0537357866150468, "policy_loss": 0.005301328950813775, "vf_loss": 2.6083377933641994, "vf_loss_unclipped": 2.907960798027419, "vf_explained_var": -9.550722931493829e-07, "entropy": 1.1387157677841593, "mean_kl_loss": 0.011628057985805282, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.13895978902644, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 14451.133, "sample_time_ms": 10670.719, "synch_weights_time_ms": 2.215}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 45, "trial_id": "ea782_00000", "date": "2024-07-15_18-22-56", "timestamp": 1721060576, "time_this_iter_s": 14.487233877182007, "time_total_s": 661.613753080368, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 661.613753080368, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.852380952380951, "ram_util_percent": 75.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04441756912230847}, "default_policy": {"total_loss": 0.04441756912230847, "policy_loss": 0.005245533727133262, "vf_loss": 2.215172355680832, "vf_loss_unclipped": 2.659986310358495, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.1779144875276317, "mean_kl_loss": 0.008854748867911353, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.9961690918946, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 14414.207, "sample_time_ms": 10635.592, "synch_weights_time_ms": 2.229}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 46, "trial_id": "ea782_00000", "date": "2024-07-15_18-23-10", "timestamp": 1721060590, "time_this_iter_s": 14.237411499023438, "time_total_s": 675.8511645793915, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 675.8511645793915, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 8.805, "ram_util_percent": 75.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04453199998245263}, "default_policy": {"total_loss": 0.04453199998245263, "policy_loss": -0.00025619996308501975, "vf_loss": 2.959609853052127, "vf_loss_unclipped": 3.811719385672734, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.0472512178456606, "mean_kl_loss": 0.007903629980007024, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.44518621406536, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 14411.072, "sample_time_ms": 10628.014, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 47, "trial_id": "ea782_00000", "date": "2024-07-15_18-23-24", "timestamp": 1721060604, "time_this_iter_s": 14.368002653121948, "time_total_s": 690.2191672325134, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 690.2191672325134, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.776190476190479, "ram_util_percent": 75.56666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06364699517305233}, "default_policy": {"total_loss": 0.06364699517305233, "policy_loss": -0.002518244192445043, "vf_loss": 5.099332742345359, "vf_loss_unclipped": 11.025622126898531, "vf_explained_var": -9.548181155597222e-07, "entropy": 1.0618222672929134, "mean_kl_loss": 0.007893127136703542, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.97199889919204, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14418.957, "sample_time_ms": 10634.176, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 48, "trial_id": "ea782_00000", "date": "2024-07-15_18-23-39", "timestamp": 1721060619, "time_this_iter_s": 14.44433856010437, "time_total_s": 704.6635057926178, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 704.6635057926178, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 8.28, "ram_util_percent": 75.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06595338709644481}, "default_policy": {"total_loss": 0.06595338709644481, "policy_loss": 0.0006028622208135341, "vf_loss": 4.08925784244212, "vf_loss_unclipped": 8.777487242908112, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.0733061362939602, "mean_kl_loss": 0.01272414789721829, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.20457631267027, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 14420.3, "sample_time_ms": 10632.345, "synch_weights_time_ms": 2.204}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 49, "trial_id": "ea782_00000", "date": "2024-07-15_18-23-53", "timestamp": 1721060633, "time_this_iter_s": 14.380568504333496, "time_total_s": 719.0440742969513, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 719.0440742969513, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 8.52857142857143, "ram_util_percent": 75.59047619047617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.049439606204160304}, "default_policy": {"total_loss": 0.049439606204160304, "policy_loss": 0.0009980962188767472, "vf_loss": 2.9332389600241364, "vf_loss_unclipped": 3.7273333920344616, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.0983530033880204, "mean_kl_loss": 0.009941442177037962, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.5587475038615, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 14415.655, "sample_time_ms": 10624.193, "synch_weights_time_ms": 2.255}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 50, "trial_id": "ea782_00000", "date": "2024-07-15_18-24-08", "timestamp": 1721060648, "time_this_iter_s": 14.466727018356323, "time_total_s": 733.5108013153076, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 733.5108013153076, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.555, "ram_util_percent": 75.60999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04130538206037158}, "default_policy": {"total_loss": 0.04130538206037158, "policy_loss": 0.002338806896019719, "vf_loss": 2.4471011458874257, "vf_loss_unclipped": 2.8369396218041114, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.9920889441646746, "mean_kl_loss": 0.007541259451370154, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 256.7976770004985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 14547.573, "sample_time_ms": 10702.429, "synch_weights_time_ms": 2.283}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 51, "trial_id": "ea782_00000", "date": "2024-07-15_18-24-23", "timestamp": 1721060663, "time_this_iter_s": 15.578435182571411, "time_total_s": 749.089236497879, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.089236497879, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 8.582608695652175, "ram_util_percent": 75.67826086956525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.054918878086244884}, "default_policy": {"total_loss": 0.054918878086244884, "policy_loss": 0.0044649895335208065, "vf_loss": 3.0498674023253067, "vf_loss_unclipped": 4.221987110528865, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.0031250379105876, "mean_kl_loss": 0.010381618003881694, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.9221680164337158}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}}, "episode_reward_max": -10756.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11414.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45753881119234263, "mean_inference_ms": 1.1546018269053147, "mean_action_processing_ms": 0.12111485571275012, "mean_env_wait_ms": 0.9685711249974405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077152252197265625, "StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.3156709671020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.5021103823028, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14625.233, "sample_time_ms": 10756.27, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 52, "trial_id": "ea782_00000", "date": "2024-07-15_18-24-39", "timestamp": 1721060679, "time_this_iter_s": 15.298691987991333, "time_total_s": 764.3879284858704, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 764.3879284858704, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 8.533333333333331, "ram_util_percent": 75.74285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09599509558676164}, "default_policy": {"total_loss": 0.09599509558676164, "policy_loss": 0.011781882399371437, "vf_loss": 4.0176991766958094, "vf_loss_unclipped": 5.821485084765501, "vf_explained_var": -9.565973586873459e-07, "entropy": 1.016111372439846, "mean_kl_loss": 0.0229096638985808, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.8832521438598633}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 251.2304548307324, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 14781.857, "sample_time_ms": 10883.334, "synch_weights_time_ms": 2.264}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 53, "trial_id": "ea782_00000", "date": "2024-07-15_18-24-55", "timestamp": 1721060695, "time_this_iter_s": 15.9248788356781, "time_total_s": 780.3128073215485, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 780.3128073215485, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 11.391304347826088, "ram_util_percent": 76.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.052009394182873245}, "default_policy": {"total_loss": 0.052009394182873245, "policy_loss": -0.0008999602655683563, "vf_loss": 3.5269937062187235, "vf_loss_unclipped": 4.379799589737138, "vf_explained_var": -9.573598914563274e-07, "entropy": 1.0360418523806754, "mean_kl_loss": 0.006117890153498724, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.8832521438598633}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 247.8077084205931, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 14930.488, "sample_time_ms": 10940.305, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 54, "trial_id": "ea782_00000", "date": "2024-07-15_18-25-11", "timestamp": 1721060711, "time_this_iter_s": 16.14387059211731, "time_total_s": 796.4566779136658, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 796.4566779136658, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 8.878260869565217, "ram_util_percent": 76.24347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.053093306091763}, "default_policy": {"total_loss": 0.053093306091763, "policy_loss": 0.003495367263743618, "vf_loss": 2.8595427173668386, "vf_loss_unclipped": 3.4002685700016997, "vf_explained_var": -9.540555827907407e-07, "entropy": 0.9642036473318967, "mean_kl_loss": 0.007284313218662146, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.8832521438598633}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 247.86957462083438, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 15095.694, "sample_time_ms": 11062.103, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "ea782_00000", "date": "2024-07-15_18-25-27", "timestamp": 1721060727, "time_this_iter_s": 16.139607906341553, "time_total_s": 812.5962858200073, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 812.5962858200073, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 9.052173913043479, "ram_util_percent": 75.63478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.035936509692934215}, "default_policy": {"total_loss": 0.035936509692934215, "policy_loss": 0.002376940278117972, "vf_loss": 2.0280956638329575, "vf_loss_unclipped": 2.310396351507986, "vf_explained_var": -9.558348259183644e-07, "entropy": 0.9308488768682297, "mean_kl_loss": 0.004605429169569184, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.4416260719299316}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.48402657597495, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15098.293, "sample_time_ms": 11060.396, "synch_weights_time_ms": 2.188}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "ea782_00000", "date": "2024-07-15_18-25-41", "timestamp": 1721060741, "time_this_iter_s": 14.263731002807617, "time_total_s": 826.8600168228149, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 826.8600168228149, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 8.365, "ram_util_percent": 75.56499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05990437494748747}, "default_policy": {"total_loss": 0.05990437494748747, "policy_loss": 0.006013231355943151, "vf_loss": 2.7273513025947724, "vf_loss_unclipped": 3.322892649405038, "vf_explained_var": -9.560890035080248e-07, "entropy": 0.9547611203020824, "mean_kl_loss": 0.018463619190738224, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.4416260719299316}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 285.616134780071, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 15062.226, "sample_time_ms": 11023.871, "synch_weights_time_ms": 2.213}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "ea782_00000", "date": "2024-07-15_18-25-55", "timestamp": 1721060755, "time_this_iter_s": 14.007181167602539, "time_total_s": 840.8671979904175, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 840.8671979904175, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 8.274999999999999, "ram_util_percent": 75.51500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04380331536916805}, "default_policy": {"total_loss": 0.04380331536916805, "policy_loss": -0.0005050153014307686, "vf_loss": 2.7901002915302064, "vf_loss_unclipped": 4.14771588861561, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8081638408876431, "mean_kl_loss": 0.011381129449509433, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.4416260719299316}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 285.7470695973784, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 15017.876, "sample_time_ms": 10975.848, "synch_weights_time_ms": 2.22}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "ea782_00000", "date": "2024-07-15_18-26-09", "timestamp": 1721060769, "time_this_iter_s": 14.000948190689087, "time_total_s": 854.8681461811066, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 854.8681461811066, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 8.41, "ram_util_percent": 75.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.034846340394469655}, "default_policy": {"total_loss": 0.034846340394469655, "policy_loss": 0.0014740469327359312, "vf_loss": 2.0870543034600297, "vf_loss_unclipped": 2.2162126856826263, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8147630823700667, "mean_kl_loss": 0.008671981113882033, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.4416260719299316}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 285.81395023967724, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 14979.598, "sample_time_ms": 10933.989, "synch_weights_time_ms": 2.214}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "ea782_00000", "date": "2024-07-15_18-26-23", "timestamp": 1721060783, "time_this_iter_s": 13.997495174407959, "time_total_s": 868.8656413555145, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 868.8656413555145, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 8.239999999999998, "ram_util_percent": 75.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04089353507958543}, "default_policy": {"total_loss": 0.04089353507958543, "policy_loss": 0.004478631489378994, "vf_loss": 2.1078782642701035, "vf_loss_unclipped": 2.7856229606594867, "vf_explained_var": -9.52657606047608e-07, "entropy": 0.8851085370664658, "mean_kl_loss": 0.010638074587106205, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.4416260719299316}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.22543684966325, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 14960.672, "sample_time_ms": 10907.294, "synch_weights_time_ms": 2.208}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "ea782_00000", "date": "2024-07-15_18-26-38", "timestamp": 1721060798, "time_this_iter_s": 14.276410102844238, "time_total_s": 883.1420514583588, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 883.1420514583588, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 8.476190476190478, "ram_util_percent": 75.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09680426898283331}, "default_policy": {"total_loss": 0.09680426898283331, "policy_loss": 0.006366845625919351, "vf_loss": 4.978589496378706, "vf_loss_unclipped": 11.737323256570901, "vf_explained_var": -9.577411578408183e-07, "entropy": 0.9709002871884466, "mean_kl_loss": 0.028198385811862604, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}}, "episode_reward_max": -10152.0, "episode_reward_min": -11984.0, "episode_reward_mean": -11204.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45761552132681205, "mean_inference_ms": 1.1532248254014188, "mean_action_processing_ms": 0.12091416837656904, "mean_env_wait_ms": 0.9661451328969015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983048756917318, "StateBufferConnector_ms": 0.004132588704427083, "ViewRequirementAgentConnector_ms": 0.32025575637817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 272.03956675942084, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 14873.4, "sample_time_ms": 10844.706, "synch_weights_time_ms": 2.186}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "ea782_00000", "date": "2024-07-15_18-26-52", "timestamp": 1721060812, "time_this_iter_s": 14.706013917922974, "time_total_s": 897.8480653762817, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 897.8480653762817, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 8.54, "ram_util_percent": 75.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07680779611314538}, "default_policy": {"total_loss": 0.07680779611314538, "policy_loss": 0.005273818068686865, "vf_loss": 4.781115642996993, "vf_loss_unclipped": 7.806916320374779, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8558729276982452, "mean_kl_loss": 0.010970401504488567, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.2568370097118, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 14880.719, "sample_time_ms": 10843.757, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 62, "trial_id": "ea782_00000", "date": "2024-07-15_18-27-08", "timestamp": 1721060828, "time_this_iter_s": 15.372143268585205, "time_total_s": 913.220208644867, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 913.220208644867, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 8.749999999999998, "ram_util_percent": 75.83636363636366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0622374033941371}, "default_policy": {"total_loss": 0.0622374033941371, "policy_loss": 0.0015700049673530783, "vf_loss": 4.33831863667665, "vf_loss_unclipped": 6.4398244943445935, "vf_explained_var": -9.559619147131947e-07, "entropy": 0.8578036707093213, "mean_kl_loss": 0.007992926287378976, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.36414964504615, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 14807.366, "sample_time_ms": 10753.659, "synch_weights_time_ms": 2.183}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 63, "trial_id": "ea782_00000", "date": "2024-07-15_18-27-23", "timestamp": 1721060843, "time_this_iter_s": 15.190460205078125, "time_total_s": 928.4106688499451, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 928.4106688499451, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 9.522727272727273, "ram_util_percent": 75.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05283105609092568}, "default_policy": {"total_loss": 0.05283105609092568, "policy_loss": 0.0031630649248253245, "vf_loss": 2.5114789425945485, "vf_loss_unclipped": 2.9809988446072984, "vf_explained_var": -9.534201388165895e-07, "entropy": 0.7741355181121623, "mean_kl_loss": 0.01135440337106656, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.99414176878184, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 14680.232, "sample_time_ms": 10708.079, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 64, "trial_id": "ea782_00000", "date": "2024-07-15_18-27-38", "timestamp": 1721060858, "time_this_iter_s": 14.872344255447388, "time_total_s": 943.2830131053925, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 943.2830131053925, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 9.161904761904763, "ram_util_percent": 76.21428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06625284639490979}, "default_policy": {"total_loss": 0.06625284639490979, "policy_loss": 0.006029461719480945, "vf_loss": 2.1493221671977785, "vf_loss_unclipped": 2.2706359974356856, "vf_explained_var": -9.549452043545526e-07, "entropy": 0.7708209136655844, "mean_kl_loss": 0.01791040930032229, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.86963152883885, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 14565.339, "sample_time_ms": 10612.718, "synch_weights_time_ms": 2.22}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 65, "trial_id": "ea782_00000", "date": "2024-07-15_18-27-53", "timestamp": 1721060873, "time_this_iter_s": 14.990954399108887, "time_total_s": 958.2739675045013, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 958.2739675045013, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 9.027272727272726, "ram_util_percent": 76.27272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.040066295378863304}, "default_policy": {"total_loss": 0.040066295378863304, "policy_loss": 0.0003970640814249545, "vf_loss": 2.697902328042842, "vf_loss_unclipped": 4.57970273964949, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.6958102060279359, "mean_kl_loss": 0.005868470737925182, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.42295549277054, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 14657.702, "sample_time_ms": 10683.758, "synch_weights_time_ms": 2.208}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 66, "trial_id": "ea782_00000", "date": "2024-07-15_18-28-08", "timestamp": 1721060888, "time_this_iter_s": 15.186686515808105, "time_total_s": 973.4606540203094, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 973.4606540203094, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 9.15238095238095, "ram_util_percent": 76.43809523809526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08312722278941574}, "default_policy": {"total_loss": 0.08312722278941574, "policy_loss": 0.013461844077699188, "vf_loss": 2.808082577516275, "vf_loss_unclipped": 3.373667477417602, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.7389244892831042, "mean_kl_loss": 0.019230393580996794, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 270.1381475495306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 14737.945, "sample_time_ms": 10741.118, "synch_weights_time_ms": 2.194}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 67, "trial_id": "ea782_00000", "date": "2024-07-15_18-28-23", "timestamp": 1721060903, "time_this_iter_s": 14.809580087661743, "time_total_s": 988.2702341079712, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 988.2702341079712, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 9.195238095238093, "ram_util_percent": 76.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05811671155275527}, "default_policy": {"total_loss": 0.05811671155275527, "policy_loss": 0.0050966360145556265, "vf_loss": 2.3130774272085506, "vf_loss_unclipped": 2.9395520283278627, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.7501279207816256, "mean_kl_loss": 0.01382203347976198, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 278.43586546335416, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 14774.702, "sample_time_ms": 10748.645, "synch_weights_time_ms": 2.193}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 68, "trial_id": "ea782_00000", "date": "2024-07-15_18-28-37", "timestamp": 1721060917, "time_this_iter_s": 14.36860179901123, "time_total_s": 1002.6388359069824, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1002.6388359069824, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 8.580952380952382, "ram_util_percent": 76.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04170387573162916}, "default_policy": {"total_loss": 0.04170387573162916, "policy_loss": 0.00012801935387922247, "vf_loss": 2.7935443538973836, "vf_loss_unclipped": 4.357445562826291, "vf_explained_var": -9.550722931493829e-07, "entropy": 0.7180983028940554, "mean_kl_loss": 0.006307886005878803, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.04786245860592, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 14955.918, "sample_time_ms": 10810.108, "synch_weights_time_ms": 2.236}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 69, "trial_id": "ea782_00000", "date": "2024-07-15_18-28-53", "timestamp": 1721060933, "time_this_iter_s": 15.80965280532837, "time_total_s": 1018.4484887123108, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1018.4484887123108, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 9.059090909090909, "ram_util_percent": 76.60454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04732810874243201}, "default_policy": {"total_loss": 0.04732810874243201, "policy_loss": -0.0025081298014184815, "vf_loss": 3.5310432567144, "vf_loss_unclipped": 4.482853100815816, "vf_explained_var": -9.554535595338736e-07, "entropy": 0.7500053367126726, "mean_kl_loss": 0.00671732691807847, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}}, "episode_reward_max": -9373.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10942.714285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4576569090257842, "mean_inference_ms": 1.1524010681548238, "mean_action_processing_ms": 0.12079755708228825, "mean_env_wait_ms": 0.9640460250307349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489749363490513, "StateBufferConnector_ms": 0.0039849962506975445, "ViewRequirementAgentConnector_ms": 0.31613962990897043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 252.33574886892563, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 15113.685, "sample_time_ms": 10886.848, "synch_weights_time_ms": 2.212}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 7, "training_iteration": 70, "trial_id": "ea782_00000", "date": "2024-07-15_18-29-09", "timestamp": 1721060949, "time_this_iter_s": 15.85429573059082, "time_total_s": 1034.3027844429016, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1034.3027844429016, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 76.75217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06005692417953791}, "default_policy": {"total_loss": 0.06005692417953791, "policy_loss": 0.006254365082893735, "vf_loss": 2.4712916783559553, "vf_loss_unclipped": 2.791958187752441, "vf_explained_var": -9.540555827907407e-07, "entropy": 0.6687366520799299, "mean_kl_loss": 0.013452238211479497, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 243.78640383661997, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 15284.091, "sample_time_ms": 10948.566, "synch_weights_time_ms": 2.241}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 71, "trial_id": "ea782_00000", "date": "2024-07-15_18-29-25", "timestamp": 1721060965, "time_this_iter_s": 16.410231590270996, "time_total_s": 1050.7130160331726, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1050.7130160331726, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 9.317391304347826, "ram_util_percent": 76.80434782608695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.044348961660769515}, "default_policy": {"total_loss": 0.044348961660769515, "policy_loss": 0.0007828598284025563, "vf_loss": 2.4754190514845127, "vf_loss_unclipped": 2.6318360302748203, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.639728416130741, "mean_kl_loss": 0.008699396139999076, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 240.95274450001241, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15407.225, "sample_time_ms": 10958.465, "synch_weights_time_ms": 2.232}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 72, "trial_id": "ea782_00000", "date": "2024-07-15_18-29-42", "timestamp": 1721060982, "time_this_iter_s": 16.602613925933838, "time_total_s": 1067.3156299591064, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1067.3156299591064, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 9.741666666666665, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.046889342256446385}, "default_policy": {"total_loss": 0.046889342256446385, "policy_loss": 0.0029694222505571746, "vf_loss": 2.452149014737306, "vf_loss_unclipped": 2.863143496167685, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.6239423315281044, "mean_kl_loss": 0.008970626895143432, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.31009539689074, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 15467.507, "sample_time_ms": 10912.254, "synch_weights_time_ms": 2.27}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "ea782_00000", "date": "2024-07-15_18-29-58", "timestamp": 1721060998, "time_this_iter_s": 15.793278455734253, "time_total_s": 1083.1089084148407, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1083.1089084148407, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 9.190909090909091, "ram_util_percent": 76.74545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05149194356530651}, "default_policy": {"total_loss": 0.05149194356530651, "policy_loss": 0.0057490177408877465, "vf_loss": 2.452701078930389, "vf_loss_unclipped": 2.7716498139824695, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.6237609575488674, "mean_kl_loss": 0.0098111047750196, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.23371074033705, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 15560.056, "sample_time_ms": 10882.036, "synch_weights_time_ms": 2.249}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "ea782_00000", "date": "2024-07-15_18-30-14", "timestamp": 1721061014, "time_this_iter_s": 15.798410892486572, "time_total_s": 1098.9073193073273, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1098.9073193073273, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 8.808695652173911, "ram_util_percent": 76.83913043478263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06210136070980558}, "default_policy": {"total_loss": 0.06210136070980558, "policy_loss": 0.0026132512752260607, "vf_loss": 3.319702667150416, "vf_loss_unclipped": 5.451559258104641, "vf_explained_var": -9.532930500217593e-07, "entropy": 0.6228816908305642, "mean_kl_loss": 0.012158069019352319, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 256.3001640348817, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 15621.867, "sample_time_ms": 10828.213, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "ea782_00000", "date": "2024-07-15_18-30-29", "timestamp": 1721061029, "time_this_iter_s": 15.608778715133667, "time_total_s": 1114.516098022461, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1114.516098022461, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 8.513636363636365, "ram_util_percent": 76.90000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06165013720752048}, "default_policy": {"total_loss": 0.06165013720752048, "policy_loss": 0.005101252366095654, "vf_loss": 2.93593630035803, "vf_loss_unclipped": 3.7022225809758154, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.7277882807671643, "mean_kl_loss": 0.01257354468787347, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 254.8339526866462, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15673.047, "sample_time_ms": 10744.704, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "ea782_00000", "date": "2024-07-15_18-30-45", "timestamp": 1721061045, "time_this_iter_s": 15.698432207107544, "time_total_s": 1130.2145302295685, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1130.2145302295685, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 8.64782608695652, "ram_util_percent": 76.90000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06058602965176741}, "default_policy": {"total_loss": 0.06058602965176741, "policy_loss": 0.008482434285451163, "vf_loss": 2.662573740680589, "vf_loss_unclipped": 3.210273045975008, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.7838077128950213, "mean_kl_loss": 0.011782001740310832, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 256.6683614995071, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 15750.754, "sample_time_ms": 10706.243, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "ea782_00000", "date": "2024-07-15_18-31-01", "timestamp": 1721061061, "time_this_iter_s": 15.586697340011597, "time_total_s": 1145.80122756958, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1145.80122756958, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 8.549999999999999, "ram_util_percent": 76.90000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05041086445373894}, "default_policy": {"total_loss": 0.05041086445373894, "policy_loss": 0.0047884105758340375, "vf_loss": 2.342312746528369, "vf_loss_unclipped": 2.711212136915752, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.7893637029219792, "mean_kl_loss": 0.010265874448299683, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}}, "episode_reward_max": -9362.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10745.125, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45776374236401707, "mean_inference_ms": 1.1521915709598862, "mean_action_processing_ms": 0.12076194648715714, "mean_env_wait_ms": 0.9625566516991185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072956085205078125, "StateBufferConnector_ms": 0.004351139068603516, "ViewRequirementAgentConnector_ms": 0.31292736530303955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 257.5765163741296, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 15867.094, "sample_time_ms": 10704.724, "synch_weights_time_ms": 2.286}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "ea782_00000", "date": "2024-07-15_18-31-16", "timestamp": 1721061076, "time_this_iter_s": 15.53159213066101, "time_total_s": 1161.332819700241, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1161.332819700241, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 8.60909090909091, "ram_util_percent": 76.91363636363639}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07564503441292689}, "default_policy": {"total_loss": 0.07564503441292689, "policy_loss": 0.003169534532333424, "vf_loss": 4.823317439889094, "vf_loss_unclipped": 7.818928664109346, "vf_explained_var": -9.585036906097998e-07, "entropy": 0.8021330682199392, "mean_kl_loss": 0.01121064060117748, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 251.78212309911785, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 15875.042, "sample_time_ms": 10686.155, "synch_weights_time_ms": 2.253}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 79, "trial_id": "ea782_00000", "date": "2024-07-15_18-31-32", "timestamp": 1721061092, "time_this_iter_s": 15.889075756072998, "time_total_s": 1177.221895456314, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1177.221895456314, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 8.659090909090908, "ram_util_percent": 76.96818181818185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05386509147158929}, "default_policy": {"total_loss": 0.05386509147158929, "policy_loss": 0.005315379852226485, "vf_loss": 3.053759117116298, "vf_loss_unclipped": 3.622926893518932, "vf_explained_var": -9.572328026614973e-07, "entropy": 0.7269614786227375, "mean_kl_loss": 0.008329539260800198, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.11532494515592, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15870.16, "sample_time_ms": 10620.574, "synch_weights_time_ms": 2.275}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 80, "trial_id": "ea782_00000", "date": "2024-07-15_18-31-48", "timestamp": 1721061108, "time_this_iter_s": 15.805155992507935, "time_total_s": 1193.027051448822, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1193.027051448822, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.45217391304348, "ram_util_percent": 76.96521739130436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.049853607167257494}, "default_policy": {"total_loss": 0.049853607167257494, "policy_loss": 0.004666614270747217, "vf_loss": 2.237647234885169, "vf_loss_unclipped": 2.3232236104225046, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.6463261330559817, "mean_kl_loss": 0.01054851606484877, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 244.3446384541108, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 15866.411, "sample_time_ms": 10580.322, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 81, "trial_id": "ea782_00000", "date": "2024-07-15_18-32-04", "timestamp": 1721061124, "time_this_iter_s": 16.37234115600586, "time_total_s": 1209.3993926048279, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1209.3993926048279, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 8.665217391304347, "ram_util_percent": 76.94782608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05223820355784362}, "default_policy": {"total_loss": 0.05223820355784362, "policy_loss": 0.004995516100739524, "vf_loss": 2.1374250905218917, "vf_loss_unclipped": 2.276038265368069, "vf_explained_var": -9.55199381944213e-07, "entropy": 0.5836973359653437, "mean_kl_loss": 0.011962621007424925, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 249.6597821007238, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 15808.514, "sample_time_ms": 10488.835, "synch_weights_time_ms": 2.307}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 82, "trial_id": "ea782_00000", "date": "2024-07-15_18-32-20", "timestamp": 1721061140, "time_this_iter_s": 16.02368998527527, "time_total_s": 1225.4230825901031, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1225.4230825901031, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 76.99565217391304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.043646077043128645}, "default_policy": {"total_loss": 0.043646077043128645, "policy_loss": 0.000974119910454032, "vf_loss": 2.301747111242209, "vf_loss_unclipped": 2.5897245605363013, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.534756271315536, "mean_kl_loss": 0.00908903791760303, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 249.44177398172175, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 15833.002, "sample_time_ms": 10474.285, "synch_weights_time_ms": 2.275}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 83, "trial_id": "ea782_00000", "date": "2024-07-15_18-32-36", "timestamp": 1721061156, "time_this_iter_s": 16.03849172592163, "time_total_s": 1241.4615743160248, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1241.4615743160248, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.49130434782609, "ram_util_percent": 77.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06527922225039778}, "default_policy": {"total_loss": 0.06527922225039778, "policy_loss": 0.002643050378196434, "vf_loss": 3.7000559701848386, "vf_loss_unclipped": 7.006556559854479, "vf_explained_var": -9.550722931493829e-07, "entropy": 0.5857540103735954, "mean_kl_loss": 0.01185495422646115, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 250.8315331290636, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15848.13, "sample_time_ms": 10432.435, "synch_weights_time_ms": 2.272}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 84, "trial_id": "ea782_00000", "date": "2024-07-15_18-32-52", "timestamp": 1721061172, "time_this_iter_s": 15.949519395828247, "time_total_s": 1257.411093711853, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1257.411093711853, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 8.173913043478262, "ram_util_percent": 77.0086956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06707864570647859}, "default_policy": {"total_loss": 0.06707864570647859, "policy_loss": 0.0038071116363045886, "vf_loss": 2.781451749649129, "vf_loss_unclipped": 3.5863767359048317, "vf_explained_var": -9.564702698925156e-07, "entropy": 0.6336776693937367, "mean_kl_loss": 0.016396771172533926, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.25729643942668, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 15866.881, "sample_time_ms": 10402.017, "synch_weights_time_ms": 2.316}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 85, "trial_id": "ea782_00000", "date": "2024-07-15_18-33-08", "timestamp": 1721061188, "time_this_iter_s": 15.79607081413269, "time_total_s": 1273.2071645259857, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1273.2071645259857, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.627272727272727, "ram_util_percent": 77.0272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04206635221404069}, "default_policy": {"total_loss": 0.04206635221404069, "policy_loss": 0.0014304717007809992, "vf_loss": 2.0960874774499234, "vf_loss_unclipped": 2.258723140493639, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.6539774065269336, "mean_kl_loss": 0.009098526454274492, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 249.6013786233372, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 15899.787, "sample_time_ms": 10395.945, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 86, "trial_id": "ea782_00000", "date": "2024-07-15_18-33-24", "timestamp": 1721061204, "time_this_iter_s": 16.028102159500122, "time_total_s": 1289.2352666854858, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1289.2352666854858, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.278260869565218, "ram_util_percent": 77.03478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07477952814402818}, "default_policy": {"total_loss": 0.07477952814402818, "policy_loss": 0.005216353007955655, "vf_loss": 3.7478777862179764, "vf_loss_unclipped": 5.2400915880065995, "vf_explained_var": -9.57105713866667e-07, "entropy": 0.6974866612315941, "mean_kl_loss": 0.014837133950512381, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}}, "episode_reward_max": -9158.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10568.777777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45778755074564664, "mean_inference_ms": 1.1517099815801248, "mean_action_processing_ms": 0.12070054332484993, "mean_env_wait_ms": 0.9611877721525744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038646274142795, "StateBufferConnector_ms": 0.004257096184624566, "ViewRequirementAgentConnector_ms": 0.311483277214898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 246.8312306678699, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 15961.895, "sample_time_ms": 10398.217, "synch_weights_time_ms": 2.336}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 9, "training_iteration": 87, "trial_id": "ea782_00000", "date": "2024-07-15_18-33-40", "timestamp": 1721061220, "time_this_iter_s": 16.207838773727417, "time_total_s": 1305.4431054592133, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1305.4431054592133, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 8.421739130434784, "ram_util_percent": 76.81739130434781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07064852007835516}, "default_policy": {"total_loss": 0.07064852007835516, "policy_loss": 0.0007950768613421333, "vf_loss": 4.740340127111244, "vf_loss_unclipped": 7.7471343660151275, "vf_explained_var": -9.540555827907407e-07, "entropy": 0.7429213711956163, "mean_kl_loss": 0.01038181506309421, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 236.21967000380675, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 16102.298, "sample_time_ms": 10471.198, "synch_weights_time_ms": 2.341}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 88, "trial_id": "ea782_00000", "date": "2024-07-15_18-33-57", "timestamp": 1721061237, "time_this_iter_s": 16.9358012676239, "time_total_s": 1322.3789067268372, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1322.3789067268372, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 8.504166666666666, "ram_util_percent": 76.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05719938097960516}, "default_policy": {"total_loss": 0.05719938097960516, "policy_loss": 0.003485834098923435, "vf_loss": 3.1072653699785406, "vf_loss_unclipped": 3.5974277193104025, "vf_explained_var": -9.539284939959104e-07, "entropy": 0.699251398475948, "mean_kl_loss": 0.010470074837342766, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 243.13623943554975, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 16158.79, "sample_time_ms": 10437.183, "synch_weights_time_ms": 2.351}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 89, "trial_id": "ea782_00000", "date": "2024-07-15_18-34-14", "timestamp": 1721061254, "time_this_iter_s": 16.453999042510986, "time_total_s": 1338.8329057693481, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1338.8329057693481, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 8.475, "ram_util_percent": 76.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04546128817573825}, "default_policy": {"total_loss": 0.04546128817573825, "policy_loss": -0.00020729815577472577, "vf_loss": 3.268840905445725, "vf_loss_unclipped": 3.753061746229241, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8617311652535314, "mean_kl_loss": 0.006002564538424256, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 238.36943820625734, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 16256.55, "sample_time_ms": 10428.311, "synch_weights_time_ms": 2.352}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 90, "trial_id": "ea782_00000", "date": "2024-07-15_18-34-31", "timestamp": 1721061271, "time_this_iter_s": 16.78308343887329, "time_total_s": 1355.6159892082214, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1355.6159892082214, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.916666666666666, "ram_util_percent": 76.90416666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04385700518253452}, "default_policy": {"total_loss": 0.04385700518253452, "policy_loss": 0.0021899715468073006, "vf_loss": 2.009416996098276, "vf_loss_unclipped": 2.2507831137190495, "vf_explained_var": -9.545639379700618e-07, "entropy": 0.8534872695199971, "mean_kl_loss": 0.00997617321054679, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 234.54636901884928, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 16324.939, "sample_time_ms": 10383.737, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "ea782_00000", "date": "2024-07-15_18-34-48", "timestamp": 1721061288, "time_this_iter_s": 17.05669355392456, "time_total_s": 1372.672682762146, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1372.672682762146, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 8.75, "ram_util_percent": 76.90833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06384998372297233}, "default_policy": {"total_loss": 0.06384998372297233, "policy_loss": 0.00768746099551953, "vf_loss": 2.5567991047271534, "vf_loss_unclipped": 2.8664952623310374, "vf_explained_var": -9.579953354304788e-07, "entropy": 0.8786586542754794, "mean_kl_loss": 0.014148160502450343, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 232.41041069425984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 16443.852, "sample_time_ms": 10383.608, "synch_weights_time_ms": 2.254}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "ea782_00000", "date": "2024-07-15_18-35-05", "timestamp": 1721061305, "time_this_iter_s": 17.21320128440857, "time_total_s": 1389.8858840465546, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1389.8858840465546, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 8.0875, "ram_util_percent": 76.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04035580233096886}, "default_policy": {"total_loss": 0.04035580233096886, "policy_loss": 0.0014877268857856802, "vf_loss": 2.1130517131166417, "vf_loss_unclipped": 3.0019096997437447, "vf_explained_var": -9.558348259183644e-07, "entropy": 0.7491185457340436, "mean_kl_loss": 0.008202571791252243, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 234.6220720882803, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 16545.139, "sample_time_ms": 10347.818, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "ea782_00000", "date": "2024-07-15_18-35-22", "timestamp": 1721061322, "time_this_iter_s": 17.05074715614319, "time_total_s": 1406.9366312026978, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1406.9366312026978, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 8.708, "ram_util_percent": 77.012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.044120674140439596}, "default_policy": {"total_loss": 0.044120674140439596, "policy_loss": 0.0034906975666819605, "vf_loss": 1.8646605340783784, "vf_loss_unclipped": 1.9439682386704344, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.6298685456389812, "mean_kl_loss": 0.010166008085958031, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 232.975299562149, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 16667.364, "sample_time_ms": 10323.251, "synch_weights_time_ms": 2.295}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "ea782_00000", "date": "2024-07-15_18-35-39", "timestamp": 1721061339, "time_this_iter_s": 17.171568632125854, "time_total_s": 1424.1081998348236, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1424.1081998348236, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 8.6, "ram_util_percent": 77.02083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06505129648559192}, "default_policy": {"total_loss": 0.06505129648559192, "policy_loss": 0.003635750948213168, "vf_loss": 2.7737665243748664, "vf_loss_unclipped": 4.7346896422443105, "vf_explained_var": -9.549452043545526e-07, "entropy": 0.581189098611061, "mean_kl_loss": 0.015574027919200565, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 228.60753532351092, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 16837.666, "sample_time_ms": 10336.049, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "ea782_00000", "date": "2024-07-15_18-35-57", "timestamp": 1721061357, "time_this_iter_s": 17.499485969543457, "time_total_s": 1441.607685804367, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1441.607685804367, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 8.508000000000001, "ram_util_percent": 77.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0607223971955367}, "default_policy": {"total_loss": 0.0607223971955367, "policy_loss": 0.0004621308846975059, "vf_loss": 4.345916373833918, "vf_loss_unclipped": 6.4737764893691425, "vf_explained_var": -9.543097603804014e-07, "entropy": 0.5954966970852443, "mean_kl_loss": 0.007769514858252744, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}}, "episode_reward_max": -9068.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10418.7, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45774730460187685, "mean_inference_ms": 1.1508645573160794, "mean_action_processing_ms": 0.12059086398609516, "mean_env_wait_ms": 0.9599024504021424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00825643539428711, "StateBufferConnector_ms": 0.004215240478515625, "ViewRequirementAgentConnector_ms": 0.31292200088500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 223.9819037447725, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 17020.969, "sample_time_ms": 10370.394, "synch_weights_time_ms": 2.23}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "ea782_00000", "date": "2024-07-15_18-36-15", "timestamp": 1721061375, "time_this_iter_s": 17.860657215118408, "time_total_s": 1459.4683430194855, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1459.4683430194855, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 8.25, "ram_util_percent": 77.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05616244581899842}, "default_policy": {"total_loss": 0.05616244581899842, "policy_loss": 0.0010775259481484829, "vf_loss": 3.6682927178294418, "vf_loss_unclipped": 5.012331187026079, "vf_explained_var": -9.543097603804014e-07, "entropy": 0.632426899474567, "mean_kl_loss": 0.008509833185401036, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.83846931597108, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 17211.709, "sample_time_ms": 10412.64, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 97, "trial_id": "ea782_00000", "date": "2024-07-15_18-36-33", "timestamp": 1721061393, "time_this_iter_s": 18.115283250808716, "time_total_s": 1477.5836262702942, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1477.5836262702942, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 8.768, "ram_util_percent": 77.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.073019238220635}, "default_policy": {"total_loss": 0.073019238220635, "policy_loss": 0.004540161467465097, "vf_loss": 3.0821994736885974, "vf_loss_unclipped": 3.838228711632015, "vf_explained_var": -9.560890035080248e-07, "entropy": 0.5893043839473968, "mean_kl_loss": 0.01741417245316341, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 224.27327145108725, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 17301.907, "sample_time_ms": 10369.326, "synch_weights_time_ms": 2.211}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 98, "trial_id": "ea782_00000", "date": "2024-07-15_18-36-51", "timestamp": 1721061411, "time_this_iter_s": 17.837479829788208, "time_total_s": 1495.4211061000824, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1495.4211061000824, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 8.684615384615384, "ram_util_percent": 77.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.051796670263654976}, "default_policy": {"total_loss": 0.051796670263654976, "policy_loss": 0.004985362982877822, "vf_loss": 2.6379756321912127, "vf_loss_unclipped": 3.028501058247552, "vf_explained_var": -9.569786250718366e-07, "entropy": 0.6515505461296293, "mean_kl_loss": 0.009448384770925945, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 224.77001160517497, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 17436.336, "sample_time_ms": 10390.182, "synch_weights_time_ms": 2.191}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 99, "trial_id": "ea782_00000", "date": "2024-07-15_18-37-09", "timestamp": 1721061429, "time_this_iter_s": 17.79808211326599, "time_total_s": 1513.2191882133484, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1513.2191882133484, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 8.655999999999999, "ram_util_percent": 77.116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.055731403588035355}, "default_policy": {"total_loss": 0.055731403588035355, "policy_loss": -0.000842426706955377, "vf_loss": 3.3599631630027216, "vf_loss_unclipped": 4.247717976061774, "vf_explained_var": -9.567244474821762e-07, "entropy": 0.7345718144099596, "mean_kl_loss": 0.010624208057776831, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 224.90631426033391, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 17536.786, "sample_time_ms": 10393.391, "synch_weights_time_ms": 2.185}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 100, "trial_id": "ea782_00000", "date": "2024-07-15_18-37-26", "timestamp": 1721061446, "time_this_iter_s": 17.787046194076538, "time_total_s": 1531.006234407425, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.006234407425, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 8.920000000000002, "ram_util_percent": 77.15599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04287706312935934}, "default_policy": {"total_loss": 0.04287706312935934, "policy_loss": 0.0008926705498474715, "vf_loss": 2.9947909497375935, "vf_loss_unclipped": 4.773303787273639, "vf_explained_var": -9.574869802511577e-07, "entropy": 0.7114045891299177, "mean_kl_loss": 0.0055661625953935786, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 226.76320993579063, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 17595.321, "sample_time_ms": 10373.601, "synch_weights_time_ms": 2.203}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 101, "trial_id": "ea782_00000", "date": "2024-07-15_18-37-44", "timestamp": 1721061464, "time_this_iter_s": 17.64190697669983, "time_total_s": 1548.6481413841248, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1548.6481413841248, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 8.499999999999998, "ram_util_percent": 77.16538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.059500685667615134}, "default_policy": {"total_loss": 0.059500685667615134, "policy_loss": 0.0050666609492057615, "vf_loss": 3.1521698689537008, "vf_loss_unclipped": 5.199956413970065, "vf_explained_var": -9.567244474821762e-07, "entropy": 0.7069765211803827, "mean_kl_loss": 0.010595594601498282, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 226.18126996215784, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 17642.721, "sample_time_ms": 10362.206, "synch_weights_time_ms": 2.228}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 102, "trial_id": "ea782_00000", "date": "2024-07-15_18-38-02", "timestamp": 1721061482, "time_this_iter_s": 17.68768548965454, "time_total_s": 1566.3358268737793, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1566.3358268737793, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 8.508, "ram_util_percent": 77.18400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04750216979164082}, "default_policy": {"total_loss": 0.04750216979164082, "policy_loss": 0.0005543800477963139, "vf_loss": 2.1789938816701424, "vf_loss_unclipped": 2.489873328601628, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.6480990602517687, "mean_kl_loss": 0.011634017720802137, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 223.0483174506904, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 17731.185, "sample_time_ms": 10399.856, "synch_weights_time_ms": 2.208}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 103, "trial_id": "ea782_00000", "date": "2024-07-15_18-38-20", "timestamp": 1721061500, "time_this_iter_s": 17.935343265533447, "time_total_s": 1584.2711701393127, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1584.2711701393127, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 8.959999999999999, "ram_util_percent": 77.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04606886615734428}, "default_policy": {"total_loss": 0.04606886615734428, "policy_loss": 0.00029481781586043553, "vf_loss": 2.30817941028172, "vf_loss_unclipped": 2.506721666626839, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.7794583711161542, "mean_kl_loss": 0.01049382625621677, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 224.27727388487793, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 17797.772, "sample_time_ms": 10427.808, "synch_weights_time_ms": 2.21}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 104, "trial_id": "ea782_00000", "date": "2024-07-15_18-38-38", "timestamp": 1721061518, "time_this_iter_s": 17.837206840515137, "time_total_s": 1602.1083769798279, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1602.1083769798279, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 8.811538461538463, "ram_util_percent": 77.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.057562674592826955}, "default_policy": {"total_loss": 0.057562674592826955, "policy_loss": 0.0023234258753372663, "vf_loss": 3.716419321959461, "vf_loss_unclipped": 4.507613722385882, "vf_explained_var": -9.540555827907407e-07, "entropy": 0.8383432856119518, "mean_kl_loss": 0.008358643079466467, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10281.09090909091, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45766295240444976, "mean_inference_ms": 1.1498335349293867, "mean_action_processing_ms": 0.12045495305733502, "mean_env_wait_ms": 0.9585001435935818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007917664267800072, "StateBufferConnector_ms": 0.004115971651944247, "ViewRequirementAgentConnector_ms": 0.31195553866299713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.45611540456213, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 17846.155, "sample_time_ms": 10438.228, "synch_weights_time_ms": 2.216}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 11, "training_iteration": 105, "trial_id": "ea782_00000", "date": "2024-07-15_18-38-56", "timestamp": 1721061536, "time_this_iter_s": 17.983434677124023, "time_total_s": 1620.091811656952, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1620.091811656952, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 77.21600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06006793170146692}, "default_policy": {"total_loss": 0.06006793170146692, "policy_loss": 0.001732518416898909, "vf_loss": 3.70474555300497, "vf_loss_unclipped": 5.142583882440128, "vf_explained_var": -9.550722931493829e-07, "entropy": 0.8170452647244753, "mean_kl_loss": 0.009844421177574033, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.02156596406127, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 17886.601, "sample_time_ms": 10442.045, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 106, "trial_id": "ea782_00000", "date": "2024-07-15_18-39-14", "timestamp": 1721061554, "time_this_iter_s": 18.26611590385437, "time_total_s": 1638.3579275608063, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1638.3579275608063, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 8.461538461538462, "ram_util_percent": 77.19230769230771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.047058966924259656}, "default_policy": {"total_loss": 0.047058966924259656, "policy_loss": 0.00025396839157541167, "vf_loss": 3.0854814544415423, "vf_loss_unclipped": 3.6681573135512218, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.7933082449664948, "mean_kl_loss": 0.007376016036324726, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.91219590701184, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 17894.23, "sample_time_ms": 10419.203, "synch_weights_time_ms": 2.229}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 107, "trial_id": "ea782_00000", "date": "2024-07-15_18-39-32", "timestamp": 1721061572, "time_this_iter_s": 18.19123339653015, "time_total_s": 1656.5491609573364, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1656.5491609573364, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 77.21923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05341028430109927}, "default_policy": {"total_loss": 0.05341028430109927, "policy_loss": 0.005577439904959599, "vf_loss": 2.493975488425318, "vf_loss_unclipped": 2.690004650654315, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8364053747928473, "mean_kl_loss": 0.010586698383548613, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.6531054800905, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 17931.745, "sample_time_ms": 10421.335, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 108, "trial_id": "ea782_00000", "date": "2024-07-15_18-39-50", "timestamp": 1721061590, "time_this_iter_s": 18.213082313537598, "time_total_s": 1674.762243270874, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1674.762243270874, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 8.688461538461537, "ram_util_percent": 77.28461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05861391714895204}, "default_policy": {"total_loss": 0.05861391714895204, "policy_loss": 0.006787436536954108, "vf_loss": 3.193850279616903, "vf_loss_unclipped": 3.660800408325724, "vf_explained_var": -9.543097603804014e-07, "entropy": 0.8765073119323137, "mean_kl_loss": 0.009197012596785514, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.66495430937434, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 17973.104, "sample_time_ms": 10424.756, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "ea782_00000", "date": "2024-07-15_18-40-09", "timestamp": 1721061609, "time_this_iter_s": 18.21235489845276, "time_total_s": 1692.9745981693268, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.9745981693268, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 8.353846153846153, "ram_util_percent": 77.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06093671355150275}, "default_policy": {"total_loss": 0.06093671355150275, "policy_loss": 0.0010476984177479772, "vf_loss": 4.425848003516573, "vf_loss_unclipped": 9.359644718007493, "vf_explained_var": -9.562160923028551e-07, "entropy": 0.9559149840620281, "mean_kl_loss": 0.007228197877629854, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.96610975320263, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 440000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 18038.192, "sample_time_ms": 10460.208, "synch_weights_time_ms": 2.184}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "ea782_00000", "date": "2024-07-15_18-40-27", "timestamp": 1721061627, "time_this_iter_s": 18.43823766708374, "time_total_s": 1711.4128358364105, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1711.4128358364105, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 8.96153846153846, "ram_util_percent": 77.22307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06098805423845837}, "default_policy": {"total_loss": 0.06098805423845837, "policy_loss": 0.0037198099426861636, "vf_loss": 3.6859079792555463, "vf_loss_unclipped": 5.922154643006925, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.9533328607138286, "mean_kl_loss": 0.009438029401515446, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.89868897879495, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 444000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 18076.861, "sample_time_ms": 10477.983, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "ea782_00000", "date": "2024-07-15_18-40-45", "timestamp": 1721061645, "time_this_iter_s": 18.02836775779724, "time_total_s": 1729.4412035942078, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1729.4412035942078, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 8.265384615384615, "ram_util_percent": 77.26538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06029729584955783}, "default_policy": {"total_loss": 0.06029729584955783, "policy_loss": 0.005024048380617267, "vf_loss": 2.453977589922419, "vf_loss_unclipped": 2.8753998185525824, "vf_explained_var": -9.529117836372685e-07, "entropy": 0.848218468905512, "mean_kl_loss": 0.014212412051985592, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.88949304592273, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 18102.98, "sample_time_ms": 10483.736, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "ea782_00000", "date": "2024-07-15_18-41-03", "timestamp": 1721061663, "time_this_iter_s": 17.9486665725708, "time_total_s": 1747.3898701667786, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1747.3898701667786, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 8.396153846153846, "ram_util_percent": 77.23846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.044796863620453424}, "default_policy": {"total_loss": 0.044796863620453424, "policy_loss": 0.0006650688646952989, "vf_loss": 2.2884110357207277, "vf_loss_unclipped": 2.786627569178274, "vf_explained_var": -9.548181155597222e-07, "entropy": 0.8554998791294057, "mean_kl_loss": 0.009825797521453442, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10201.25, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45755315774041144, "mean_inference_ms": 1.148654069042659, "mean_action_processing_ms": 0.12029921288924479, "mean_env_wait_ms": 0.9572207740801599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665157318115234, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.3103196620941162}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.89923435312406, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 452000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 18120.428, "sample_time_ms": 10497.293, "synch_weights_time_ms": 2.179}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "ea782_00000", "date": "2024-07-15_18-41-21", "timestamp": 1721061681, "time_this_iter_s": 18.11002016067505, "time_total_s": 1765.4998903274536, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1765.4998903274536, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 8.804, "ram_util_percent": 77.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0698864489211949}, "default_policy": {"total_loss": 0.0698864489211949, "policy_loss": 6.744395723062029e-05, "vf_loss": 5.1429570234660655, "vf_loss_unclipped": 8.265635114870092, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.9408772456874726, "mean_kl_loss": 0.008504024292780474, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.8560110732062, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 456000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 18207.338, "sample_time_ms": 10554.82, "synch_weights_time_ms": 2.169}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 114, "trial_id": "ea782_00000", "date": "2024-07-15_18-41-40", "timestamp": 1721061700, "time_this_iter_s": 18.70652985572815, "time_total_s": 1784.2064201831818, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1784.2064201831818, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 8.903703703703705, "ram_util_percent": 77.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07389936979432135}, "default_policy": {"total_loss": 0.07389936979432135, "policy_loss": -0.0008310953151188425, "vf_loss": 4.865772187900442, "vf_loss_unclipped": 7.23567267070447, "vf_explained_var": -9.5863077940463e-07, "entropy": 0.8389410865840627, "mean_kl_loss": 0.012057099937704449, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.67158853421589, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 460000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 18205.599, "sample_time_ms": 10553.707, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 115, "trial_id": "ea782_00000", "date": "2024-07-15_18-41-58", "timestamp": 1721061718, "time_this_iter_s": 17.96590518951416, "time_total_s": 1802.172325372696, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1802.172325372696, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 8.734615384615385, "ram_util_percent": 77.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05746429615608379}, "default_policy": {"total_loss": 0.05746429615608379, "policy_loss": 0.0038134915136626914, "vf_loss": 2.513829564489027, "vf_loss_unclipped": 2.8046269302429168, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.8976715630305602, "mean_kl_loss": 0.013185347385759374, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.5779195592303, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 464000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 18184.528, "sample_time_ms": 10536.004, "synch_weights_time_ms": 2.119}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 116, "trial_id": "ea782_00000", "date": "2024-07-15_18-42-16", "timestamp": 1721061736, "time_this_iter_s": 18.05517888069153, "time_total_s": 1820.2275042533875, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1820.2275042533875, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 8.767999999999999, "ram_util_percent": 77.37200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04499990062099069}, "default_policy": {"total_loss": 0.04499990062099069, "policy_loss": 0.0005042121675151434, "vf_loss": 2.819129461227958, "vf_loss_unclipped": 3.7511231946919774, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.9397766128150639, "mean_kl_loss": 0.007539817127773959, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.27155026231412, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 468000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 18189.843, "sample_time_ms": 10540.666, "synch_weights_time_ms": 2.126}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 117, "trial_id": "ea782_00000", "date": "2024-07-15_18-42-34", "timestamp": 1721061754, "time_this_iter_s": 18.24430537223816, "time_total_s": 1838.4718096256256, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1838.4718096256256, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 8.515384615384615, "ram_util_percent": 77.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06436116847510971}, "default_policy": {"total_loss": 0.06436116847510971, "policy_loss": 0.00014278324924584136, "vf_loss": 4.138189987396634, "vf_loss_unclipped": 5.892138916101537, "vf_explained_var": -9.57614069045988e-07, "entropy": 0.854067424403579, "mean_kl_loss": 0.010560522581699979, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.22686501084763, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 472000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 18185.098, "sample_time_ms": 10531.88, "synch_weights_time_ms": 2.184}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 118, "trial_id": "ea782_00000", "date": "2024-07-15_18-42-52", "timestamp": 1721061772, "time_this_iter_s": 18.165576934814453, "time_total_s": 1856.63738656044, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1856.63738656044, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 8.65, "ram_util_percent": 77.39615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0640847578958503}, "default_policy": {"total_loss": 0.0640847578958503, "policy_loss": 0.0042779236934634285, "vf_loss": 3.1502546014816266, "vf_loss_unclipped": 5.337395090029946, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.8300524991331324, "mean_kl_loss": 0.013089058823252557, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.509608161341, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 476000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 18161.818, "sample_time_ms": 10507.451, "synch_weights_time_ms": 2.2}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 119, "trial_id": "ea782_00000", "date": "2024-07-15_18-43-10", "timestamp": 1721061790, "time_this_iter_s": 17.979167938232422, "time_total_s": 1874.6165544986725, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1874.6165544986725, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 8.446153846153846, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0535055081085014}, "default_policy": {"total_loss": 0.0535055081085014, "policy_loss": 0.004804031806749734, "vf_loss": 3.353515266228332, "vf_loss_unclipped": 5.568937555940421, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.893522970712007, "mean_kl_loss": 0.007013526971329364, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.96598903102722, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 480000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 18136.675, "sample_time_ms": 10470.075, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 120, "trial_id": "ea782_00000", "date": "2024-07-15_18-43-29", "timestamp": 1721061809, "time_this_iter_s": 18.186805248260498, "time_total_s": 1892.803359746933, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1892.803359746933, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 8.615384615384615, "ram_util_percent": 77.40384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.046811534862306076}, "default_policy": {"total_loss": 0.046811534862306076, "policy_loss": 0.004602699576299201, "vf_loss": 2.598948822664554, "vf_loss_unclipped": 2.8962913969559456, "vf_explained_var": -9.545639379700618e-07, "entropy": 0.8846890181620747, "mean_kl_loss": 0.007500489033272563, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.0854619006628, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 484000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 18151.527, "sample_time_ms": 10475.768, "synch_weights_time_ms": 2.18}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 121, "trial_id": "ea782_00000", "date": "2024-07-15_18-43-47", "timestamp": 1721061827, "time_this_iter_s": 18.176887035369873, "time_total_s": 1910.9802467823029, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1910.9802467823029, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 8.403846153846153, "ram_util_percent": 77.40769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.046351319467867295}, "default_policy": {"total_loss": 0.046351319467867295, "policy_loss": 0.0023278429854049613, "vf_loss": 2.9221966619303488, "vf_loss_unclipped": 3.5690616484262794, "vf_explained_var": -9.559619147131947e-07, "entropy": 1.0189214883836857, "mean_kl_loss": 0.006844822833369178, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10150.384615384615, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574465360743704, "mean_inference_ms": 1.1475381246009972, "mean_action_processing_ms": 0.12014452321601712, "mean_env_wait_ms": 0.9561619262260973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.0040017641507662256, "ViewRequirementAgentConnector_ms": 0.3109620167658879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.52540118960064, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 488000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 18187.366, "sample_time_ms": 10490.676, "synch_weights_time_ms": 2.152}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 122, "trial_id": "ea782_00000", "date": "2024-07-15_18-44-05", "timestamp": 1721061845, "time_this_iter_s": 18.30745553970337, "time_total_s": 1929.2877023220062, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1929.2877023220062, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 77.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08386365702149393}, "default_policy": {"total_loss": 0.08386365702149393, "policy_loss": 0.002658738055701322, "vf_loss": 4.067557435554228, "vf_loss_unclipped": 6.054909589702387, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.9403453190316523, "mean_kl_loss": 0.01874242134619135, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.06782689417713, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 492000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 18236.464, "sample_time_ms": 10524.121, "synch_weights_time_ms": 2.17}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 123, "trial_id": "ea782_00000", "date": "2024-07-15_18-44-24", "timestamp": 1721061864, "time_this_iter_s": 18.60083556175232, "time_total_s": 1947.8885378837585, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1947.8885378837585, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 8.819230769230769, "ram_util_percent": 77.41538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.056459974238414694}, "default_policy": {"total_loss": 0.056459974238414694, "policy_loss": -0.0026908063628613504, "vf_loss": 4.473910267101422, "vf_loss_unclipped": 5.961972536245135, "vf_explained_var": -9.567244474821762e-07, "entropy": 0.8800041746101908, "mean_kl_loss": 0.006664548631469283, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.0467641114315, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 496000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 18167.469, "sample_time_ms": 10470.454, "synch_weights_time_ms": 2.184}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 124, "trial_id": "ea782_00000", "date": "2024-07-15_18-44-42", "timestamp": 1721061882, "time_this_iter_s": 18.016275644302368, "time_total_s": 1965.904813528061, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1965.904813528061, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 8.580769230769231, "ram_util_percent": 77.35384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.060113063761229706}, "default_policy": {"total_loss": 0.060113063761229706, "policy_loss": 0.007934049252412721, "vf_loss": 2.331391792688797, "vf_loss_unclipped": 2.5798618778236895, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.8405078056651646, "mean_kl_loss": 0.013348398576386328, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.35417919203522, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 500000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 18228.507, "sample_time_ms": 10487.536, "synch_weights_time_ms": 2.2}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 125, "trial_id": "ea782_00000", "date": "2024-07-15_18-45-00", "timestamp": 1721061900, "time_this_iter_s": 18.576084852218628, "time_total_s": 1984.4808983802795, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1984.4808983802795, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 8.834615384615386, "ram_util_percent": 77.11153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07247687620557607}, "default_policy": {"total_loss": 0.07247687620557607, "policy_loss": 0.003409596119842518, "vf_loss": 4.8197175594789385, "vf_loss_unclipped": 7.005694108731203, "vf_explained_var": -9.579953354304788e-07, "entropy": 0.8019321366413824, "mean_kl_loss": 0.00965118819302487, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.438286840207, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 504000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 18229.645, "sample_time_ms": 10469.207, "synch_weights_time_ms": 2.255}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 126, "trial_id": "ea782_00000", "date": "2024-07-15_18-45-18", "timestamp": 1721061918, "time_this_iter_s": 18.065704345703125, "time_total_s": 2002.5466027259827, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2002.5466027259827, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 8.684615384615384, "ram_util_percent": 77.10384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06971950353687204}, "default_policy": {"total_loss": 0.06971950353687204, "policy_loss": 0.012865031864355081, "vf_loss": 2.5691320490735428, "vf_loss_unclipped": 3.0931060746915815, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.7742771985434266, "mean_kl_loss": 0.014411114353131426, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.01615198651348, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 508000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 18207.094, "sample_time_ms": 10439.214, "synch_weights_time_ms": 2.258}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "ea782_00000", "date": "2024-07-15_18-45-36", "timestamp": 1721061936, "time_this_iter_s": 18.019034385681152, "time_total_s": 2020.5656371116638, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2020.5656371116638, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 8.680769230769231, "ram_util_percent": 77.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04114792045644685}, "default_policy": {"total_loss": 0.04114792045644685, "policy_loss": 0.0001850846334735849, "vf_loss": 2.8202259421094396, "vf_loss_unclipped": 4.563571983563112, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.6947813325090957, "mean_kl_loss": 0.005901012659071759, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 224.6318829984078, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 18171.475, "sample_time_ms": 10391.466, "synch_weights_time_ms": 2.23}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "ea782_00000", "date": "2024-07-15_18-45-54", "timestamp": 1721061954, "time_this_iter_s": 17.809045791625977, "time_total_s": 2038.3746829032898, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2038.3746829032898, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 8.644, "ram_util_percent": 77.112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04782501001333965}, "default_policy": {"total_loss": 0.04782501001333965, "policy_loss": 0.0042427715305278675, "vf_loss": 1.9919721803494863, "vf_loss_unclipped": 2.2432016229896403, "vf_explained_var": -9.563431810976854e-07, "entropy": 0.7050892314486412, "mean_kl_loss": 0.010942513821514704, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.10536293466967, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 516000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 18199.406, "sample_time_ms": 10409.782, "synch_weights_time_ms": 2.235}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "ea782_00000", "date": "2024-07-15_18-46-13", "timestamp": 1721061973, "time_this_iter_s": 18.258191347122192, "time_total_s": 2056.632874250412, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2056.632874250412, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 8.569230769230769, "ram_util_percent": 77.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07463925369461176}, "default_policy": {"total_loss": 0.07463925369461176, "policy_loss": 0.009270468863275354, "vf_loss": 2.3049059658289464, "vf_loss_unclipped": 2.9422762020945803, "vf_explained_var": -9.521492508682869e-07, "entropy": 0.6921449252791496, "mean_kl_loss": 0.01957036750504066, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.4089576383465, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 520000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 18212.37, "sample_time_ms": 10420.91, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "ea782_00000", "date": "2024-07-15_18-46-31", "timestamp": 1721061991, "time_this_iter_s": 18.316818237304688, "time_total_s": 2074.9496924877167, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2074.9496924877167, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 8.876923076923077, "ram_util_percent": 77.24615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04635796567270242}, "default_policy": {"total_loss": 0.04635796567270242, "policy_loss": -0.0020763625108849394, "vf_loss": 3.503365579889273, "vf_loss_unclipped": 4.403260053284387, "vf_explained_var": -9.545639379700618e-07, "entropy": 0.7911610243035786, "mean_kl_loss": 0.006197017143562517, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10126.0, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45734123485303346, "mean_inference_ms": 1.14640081462337, "mean_action_processing_ms": 0.1199901310293204, "mean_env_wait_ms": 0.9552397197403704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007346698216029576, "StateBufferConnector_ms": 0.003964560372488839, "ViewRequirementAgentConnector_ms": 0.31269959041050505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.89111270860585, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 524000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 18222.287, "sample_time_ms": 10422.56, "synch_weights_time_ms": 2.231}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "ea782_00000", "date": "2024-07-15_18-46-49", "timestamp": 1721062009, "time_this_iter_s": 18.27619481086731, "time_total_s": 2093.225887298584, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2093.225887298584, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 8.903846153846153, "ram_util_percent": 77.30384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07466681360620568}, "default_policy": {"total_loss": 0.07466681360620568, "policy_loss": 0.005516032986184046, "vf_loss": 4.19612755907624, "vf_loss_unclipped": 6.577702648159283, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.7656966054490381, "mean_kl_loss": 0.012573535134727289, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.73183839410868, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 528000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 18263.34, "sample_time_ms": 10463.306, "synch_weights_time_ms": 2.285}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 132, "trial_id": "ea782_00000", "date": "2024-07-15_18-47-08", "timestamp": 1721062028, "time_this_iter_s": 18.717315673828125, "time_total_s": 2111.943202972412, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2111.943202972412, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 8.725925925925926, "ram_util_percent": 77.37037037037038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.055619606742266015}, "default_policy": {"total_loss": 0.055619606742266015, "policy_loss": 0.00012487405513935505, "vf_loss": 4.036491047789547, "vf_loss_unclipped": 5.166920601495548, "vf_explained_var": -9.548181155597222e-07, "entropy": 0.8433364272625969, "mean_kl_loss": 0.006996647081397318, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.98918675678735, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 532000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 18230.036, "sample_time_ms": 10428.168, "synch_weights_time_ms": 2.299}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 133, "trial_id": "ea782_00000", "date": "2024-07-15_18-47-26", "timestamp": 1721062046, "time_this_iter_s": 18.267925262451172, "time_total_s": 2130.2111282348633, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2130.2111282348633, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 8.830769230769231, "ram_util_percent": 77.3923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.051619323516097756}, "default_policy": {"total_loss": 0.051619323516097756, "policy_loss": 0.00533424216513234, "vf_loss": 2.0244831852058867, "vf_loss_unclipped": 2.3558006695847014, "vf_explained_var": -9.538014052010803e-07, "entropy": 0.8128171773480454, "mean_kl_loss": 0.012042073878259939, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.25949446173502, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 536000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 18261.295, "sample_time_ms": 10446.093, "synch_weights_time_ms": 2.304}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 134, "trial_id": "ea782_00000", "date": "2024-07-15_18-47-45", "timestamp": 1721062065, "time_this_iter_s": 18.32951045036316, "time_total_s": 2148.5406386852264, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2148.5406386852264, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 8.592307692307692, "ram_util_percent": 77.45384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03757493867517026}, "default_policy": {"total_loss": 0.03757493867517026, "policy_loss": -9.193299894235028e-05, "vf_loss": 2.1471967975468016, "vf_loss_unclipped": 2.432850533711122, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.8183913910185604, "mean_kl_loss": 0.007489184969397602, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.24574366828878, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 540000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 18220.043, "sample_time_ms": 10428.383, "synch_weights_time_ms": 2.332}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 135, "trial_id": "ea782_00000", "date": "2024-07-15_18-48-03", "timestamp": 1721062083, "time_this_iter_s": 18.16401219367981, "time_total_s": 2166.7046508789062, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2166.7046508789062, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 8.553846153846154, "ram_util_percent": 77.49615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.048076867201387374}, "default_policy": {"total_loss": 0.048076867201387374, "policy_loss": -0.0006784612599855611, "vf_loss": 3.3251409114423844, "vf_loss_unclipped": 5.432680182238378, "vf_explained_var": -9.574869802511577e-07, "entropy": 0.8676159156283845, "mean_kl_loss": 0.007169646288754532, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.17143886304865, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 544000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 18230.437, "sample_time_ms": 10436.025, "synch_weights_time_ms": 2.28}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 136, "trial_id": "ea782_00000", "date": "2024-07-15_18-48-21", "timestamp": 1721062101, "time_this_iter_s": 18.169914960861206, "time_total_s": 2184.8745658397675, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2184.8745658397675, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 8.707692307692307, "ram_util_percent": 77.50384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05270102857026274}, "default_policy": {"total_loss": 0.05270102857026274, "policy_loss": 0.0015454339521275813, "vf_loss": 3.077532683227108, "vf_loss_unclipped": 4.316847537245069, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.8918599896847821, "mean_kl_loss": 0.009424667813003992, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.76253241852825, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 548000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 18240.668, "sample_time_ms": 10441.08, "synch_weights_time_ms": 2.287}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 137, "trial_id": "ea782_00000", "date": "2024-07-15_18-48-39", "timestamp": 1721062119, "time_this_iter_s": 18.12134885787964, "time_total_s": 2202.995914697647, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2202.995914697647, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 8.392307692307693, "ram_util_percent": 77.54999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04416435694238588}, "default_policy": {"total_loss": 0.04416435694238588, "policy_loss": 0.003958642184396765, "vf_loss": 2.012094267395768, "vf_loss_unclipped": 2.1761023136598467, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.9244743227196146, "mean_kl_loss": 0.009288019278112288, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.4419851949394, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 552000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 18282.783, "sample_time_ms": 10487.964, "synch_weights_time_ms": 2.286}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 138, "trial_id": "ea782_00000", "date": "2024-07-15_18-48-57", "timestamp": 1721062137, "time_this_iter_s": 18.23070788383484, "time_total_s": 2221.226622581482, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2221.226622581482, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 8.673076923076923, "ram_util_percent": 77.48076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05992632062692664}, "default_policy": {"total_loss": 0.05992632062692664, "policy_loss": 0.005902565959126138, "vf_loss": 2.6583435670780475, "vf_loss_unclipped": 3.3700919137961827, "vf_explained_var": -9.55199381944213e-07, "entropy": 0.90185220339405, "mean_kl_loss": 0.012689523449373508, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 223.67959543059015, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 556000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 18245.449, "sample_time_ms": 10450.415, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 139, "trial_id": "ea782_00000", "date": "2024-07-15_18-49-15", "timestamp": 1721062155, "time_this_iter_s": 17.88481307029724, "time_total_s": 2239.111435651779, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2239.111435651779, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 8.552, "ram_util_percent": 77.416}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04975831305294403}, "default_policy": {"total_loss": 0.04975831305294403, "policy_loss": 2.9425634674902664e-05, "vf_loss": 3.1146888136228266, "vf_loss_unclipped": 3.6490107444939075, "vf_explained_var": -9.550722931493829e-07, "entropy": 0.9582457467437044, "mean_kl_loss": 0.008593075186647633, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10050.333333333334, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45723269709678294, "mean_inference_ms": 1.1452770216226587, "mean_action_processing_ms": 0.11983979515545519, "mean_env_wait_ms": 0.9543551972451717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00720977783203125, "StateBufferConnector_ms": 0.003946622212727864, "ViewRequirementAgentConnector_ms": 0.31317710876464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.38103409276815, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 560000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 18220.862, "sample_time_ms": 10423.178, "synch_weights_time_ms": 2.274}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 15, "training_iteration": 140, "trial_id": "ea782_00000", "date": "2024-07-15_18-49-33", "timestamp": 1721062173, "time_this_iter_s": 18.07117247581482, "time_total_s": 2257.182608127594, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2257.182608127594, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 8.507692307692308, "ram_util_percent": 77.42307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.041071772163332715}, "default_policy": {"total_loss": 0.041071772163332715, "policy_loss": 0.002565859021670592, "vf_loss": 2.009547228497991, "vf_loss_unclipped": 2.1426385774541257, "vf_explained_var": -9.538014052010803e-07, "entropy": 0.9148972783642791, "mean_kl_loss": 0.00851373991725516, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.12299279175912, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 564000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 18244.268, "sample_time_ms": 10447.861, "synch_weights_time_ms": 2.299}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 141, "trial_id": "ea782_00000", "date": "2024-07-15_18-49-52", "timestamp": 1721062192, "time_this_iter_s": 18.510393381118774, "time_total_s": 2275.6930015087128, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2275.6930015087128, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 8.261538461538462, "ram_util_percent": 77.41538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05192101231492214}, "default_policy": {"total_loss": 0.05192101231492214, "policy_loss": 0.0018430200995190312, "vf_loss": 2.767438973699297, "vf_loss_unclipped": 3.2203274486161497, "vf_explained_var": -9.531659612269289e-07, "entropy": 0.9860625246694601, "mean_kl_loss": 0.010360340242054927, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.73299828168322, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 568000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 18201.477, "sample_time_ms": 10402.738, "synch_weights_time_ms": 2.318}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 142, "trial_id": "ea782_00000", "date": "2024-07-15_18-50-10", "timestamp": 1721062210, "time_this_iter_s": 18.28957438468933, "time_total_s": 2293.982575893402, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2293.982575893402, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 8.246153846153847, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.042368421046091106}, "default_policy": {"total_loss": 0.042368421046091106, "policy_loss": -0.001258156913668235, "vf_loss": 2.3464236148257753, "vf_loss_unclipped": 2.9015637544045316, "vf_explained_var": -9.530388724320987e-07, "entropy": 0.9495688965961114, "mean_kl_loss": 0.009323890004087978, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.38390260742233, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 572000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 18206.54, "sample_time_ms": 10390.602, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 143, "trial_id": "ea782_00000", "date": "2024-07-15_18-50-29", "timestamp": 1721062229, "time_this_iter_s": 18.31860375404358, "time_total_s": 2312.3011796474457, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2312.3011796474457, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 8.365384615384615, "ram_util_percent": 77.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07521590417318506}, "default_policy": {"total_loss": 0.07521590417318506, "policy_loss": 0.0036932713643057957, "vf_loss": 4.708224022566383, "vf_loss_unclipped": 8.146984280680797, "vf_explained_var": -9.553264707390433e-07, "entropy": 0.908377709546323, "mean_kl_loss": 0.011302235024105727, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.68894164897003, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 576000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 18237.019, "sample_time_ms": 10414.055, "synch_weights_time_ms": 2.292}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 144, "trial_id": "ea782_00000", "date": "2024-07-15_18-50-47", "timestamp": 1721062247, "time_this_iter_s": 18.634255170822144, "time_total_s": 2330.935434818268, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2330.935434818268, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 8.633333333333333, "ram_util_percent": 77.40740740740742}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0437207382315321}, "default_policy": {"total_loss": 0.0437207382315321, "policy_loss": -0.0016992169279438345, "vf_loss": 3.1263487502328875, "vf_loss_unclipped": 6.114461544162429, "vf_explained_var": -9.535472276114198e-07, "entropy": 0.8956030783876936, "mean_kl_loss": 0.006546528383926637, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.91618714369818, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 580000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 18248.049, "sample_time_ms": 10430.382, "synch_weights_time_ms": 2.281}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "ea782_00000", "date": "2024-07-15_18-51-06", "timestamp": 1721062266, "time_this_iter_s": 18.273963451385498, "time_total_s": 2349.2093982696533, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2349.2093982696533, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 8.515384615384615, "ram_util_percent": 77.4346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05724260384447253}, "default_policy": {"total_loss": 0.05724260384447253, "policy_loss": 0.0020493294920589625, "vf_loss": 3.3080468459932533, "vf_loss_unclipped": 4.9767767488321, "vf_explained_var": -9.549452043545526e-07, "entropy": 0.9453132692684751, "mean_kl_loss": 0.010225864852989167, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.7430388489164, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 584000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 18276.786, "sample_time_ms": 10437.462, "synch_weights_time_ms": 2.304}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "ea782_00000", "date": "2024-07-15_18-51-24", "timestamp": 1721062284, "time_this_iter_s": 18.457099199295044, "time_total_s": 2367.6664974689484, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2367.6664974689484, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 8.56153846153846, "ram_util_percent": 77.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04907320473275618}, "default_policy": {"total_loss": 0.04907320473275618, "policy_loss": 0.0004510104433814091, "vf_loss": 2.918430159404588, "vf_loss_unclipped": 3.9536865682108826, "vf_explained_var": -9.545639379700618e-07, "entropy": 0.9463319457543176, "mean_kl_loss": 0.008988874978812804, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 195.40399690078365, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 588000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 18511.927, "sample_time_ms": 10601.481, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "ea782_00000", "date": "2024-07-15_18-51-45", "timestamp": 1721062305, "time_this_iter_s": 20.472644090652466, "time_total_s": 2388.139141559601, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2388.139141559601, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 9.410344827586208, "ram_util_percent": 77.60344827586205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04183512715362648}, "default_policy": {"total_loss": 0.04183512715362648, "policy_loss": 0.003997176850357576, "vf_loss": 2.42071706854077, "vf_loss_unclipped": 2.7036122098596875, "vf_explained_var": -9.55580648328704e-07, "entropy": 0.9397778871344097, "mean_kl_loss": 0.006303428814864406, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9996.9375, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45711396164487306, "mean_inference_ms": 1.1441638928090336, "mean_action_processing_ms": 0.1196914946025796, "mean_env_wait_ms": 0.9535192629498512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070154666900634766, "StateBufferConnector_ms": 0.003872811794281006, "ViewRequirementAgentConnector_ms": 0.3093406558036804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 211.6267984167487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 592000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 18579.241, "sample_time_ms": 10630.543, "synch_weights_time_ms": 2.293}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "ea782_00000", "date": "2024-07-15_18-52-03", "timestamp": 1721062323, "time_this_iter_s": 18.903380870819092, "time_total_s": 2407.04252243042, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2407.04252243042, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 9.307407407407409, "ram_util_percent": 77.61111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05630993493882292}, "default_policy": {"total_loss": 0.05630993493882292, "policy_loss": 0.0030015881125157926, "vf_loss": 2.254052331611546, "vf_loss_unclipped": 2.5492595132035234, "vf_explained_var": -9.57614069045988e-07, "entropy": 0.9950833379713966, "mean_kl_loss": 0.014228297667154647, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 196.489853567696, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 596000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 18826.697, "sample_time_ms": 10783.8, "synch_weights_time_ms": 2.285}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 149, "trial_id": "ea782_00000", "date": "2024-07-15_18-52-24", "timestamp": 1721062344, "time_this_iter_s": 20.359938144683838, "time_total_s": 2427.4024605751038, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2427.4024605751038, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 8.927586206896553, "ram_util_percent": 77.48275862068965}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04803543085250249}, "default_policy": {"total_loss": 0.04803543085250249, "policy_loss": -0.0003440520708272452, "vf_loss": 2.557230768173234, "vf_loss_unclipped": 2.8159909569886703, "vf_explained_var": -9.534201388165895e-07, "entropy": 1.0431613240287756, "mean_kl_loss": 0.010546969159554416, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 194.9087180349374, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 600000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 19072.1, "sample_time_ms": 10928.255, "synch_weights_time_ms": 2.271}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 150, "trial_id": "ea782_00000", "date": "2024-07-15_18-52-44", "timestamp": 1721062364, "time_this_iter_s": 20.52448344230652, "time_total_s": 2447.9269440174103, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2447.9269440174103, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 9.03448275862069, "ram_util_percent": 77.53103448275861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05339052195627012}, "default_policy": {"total_loss": 0.05339052195627012, "policy_loss": 0.004708606779559462, "vf_loss": 2.447598839555976, "vf_loss_unclipped": 2.760307114579276, "vf_explained_var": -9.549452043545526e-07, "entropy": 0.9874496676011889, "mean_kl_loss": 0.011193809248000964, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 201.79412962610724, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 604000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 19203.52, "sample_time_ms": 10995.306, "synch_weights_time_ms": 2.27}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 151, "trial_id": "ea782_00000", "date": "2024-07-15_18-53-04", "timestamp": 1721062384, "time_this_iter_s": 19.82438063621521, "time_total_s": 2467.7513246536255, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2467.7513246536255, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 9.12758620689655, "ram_util_percent": 77.5758620689655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.061563177361909645}, "default_policy": {"total_loss": 0.061563177361909645, "policy_loss": 0.002990539405129548, "vf_loss": 2.7773826977591525, "vf_loss_unclipped": 3.715316529340073, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.9925764336514828, "mean_kl_loss": 0.014242627854540404, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 195.91700073839567, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 608000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 19416.487, "sample_time_ms": 11120.77, "synch_weights_time_ms": 2.224}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 152, "trial_id": "ea782_00000", "date": "2024-07-15_18-53-25", "timestamp": 1721062405, "time_this_iter_s": 20.419219493865967, "time_total_s": 2488.1705441474915, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2488.1705441474915, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 9.248275862068965, "ram_util_percent": 77.58275862068965}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07497429465656595}, "default_policy": {"total_loss": 0.07497429465656595, "policy_loss": 0.003746286955977808, "vf_loss": 4.503291749369615, "vf_loss_unclipped": 7.861810968247558, "vf_explained_var": -9.534201388165895e-07, "entropy": 0.9301168352429038, "mean_kl_loss": 0.01211367872233854, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.1624391078948975}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.30921264828334, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 612000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 19451.313, "sample_time_ms": 11146.613, "synch_weights_time_ms": 2.237}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 153, "trial_id": "ea782_00000", "date": "2024-07-15_18-53-43", "timestamp": 1721062423, "time_this_iter_s": 18.667052507400513, "time_total_s": 2506.837596654892, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2506.837596654892, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 9.100000000000001, "ram_util_percent": 77.66153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.047541034471458084}, "default_policy": {"total_loss": 0.047541034471458084, "policy_loss": -0.0004289638579213448, "vf_loss": 3.7713792720583204, "vf_loss_unclipped": 7.752515199469097, "vf_explained_var": -9.560890035080248e-07, "entropy": 0.9635984123642765, "mean_kl_loss": 0.004742887525997713, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0812195539474487}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 208.99521149639492, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 616000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 19502.071, "sample_time_ms": 11158.574, "synch_weights_time_ms": 2.27}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 154, "trial_id": "ea782_00000", "date": "2024-07-15_18-54-02", "timestamp": 1721062442, "time_this_iter_s": 19.14103364944458, "time_total_s": 2525.9786303043365, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2525.9786303043365, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 8.846428571428572, "ram_util_percent": 77.71428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05125001536757707}, "default_policy": {"total_loss": 0.05125001536757707, "policy_loss": 0.0023192602749874214, "vf_loss": 3.5022233770346083, "vf_loss_unclipped": 5.778719285530831, "vf_explained_var": -9.527846948424382e-07, "entropy": 0.9728353557301991, "mean_kl_loss": 0.012863738450367795, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0812195539474487}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 205.3784894307276, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 620000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 19622.511, "sample_time_ms": 11220.465, "synch_weights_time_ms": 2.267}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 155, "trial_id": "ea782_00000", "date": "2024-07-15_18-54-22", "timestamp": 1721062462, "time_this_iter_s": 19.4782133102417, "time_total_s": 2545.4568436145782, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2545.4568436145782, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 9.11111111111111, "ram_util_percent": 77.7925925925926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0660173246425503}, "default_policy": {"total_loss": 0.0660173246425503, "policy_loss": 0.010890622576599373, "vf_loss": 3.2047556057286415, "vf_loss_unclipped": 4.987639608095958, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.9500303819362543, "mean_kl_loss": 0.021345478646478417, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.6218292713165283}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.8033771348713, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 624000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 19647.886, "sample_time_ms": 11262.918, "synch_weights_time_ms": 2.296}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 156, "trial_id": "ea782_00000", "date": "2024-07-15_18-54-41", "timestamp": 1721062481, "time_this_iter_s": 18.71096920967102, "time_total_s": 2564.1678128242493, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2564.1678128242493, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 8.692592592592591, "ram_util_percent": 77.89629629629631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04286727709457405}, "default_policy": {"total_loss": 0.04286727709457405, "policy_loss": 0.0001285056733011977, "vf_loss": 2.483618286881111, "vf_loss_unclipped": 2.814378649949519, "vf_explained_var": -9.5367431640625e-07, "entropy": 0.9091252831380758, "mean_kl_loss": 0.011038516268367693, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.6218292713165283}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9982.70588235294, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45702968813033956, "mean_inference_ms": 1.1432505186816793, "mean_action_processing_ms": 0.11956854921143245, "mean_env_wait_ms": 0.9528752535175584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00693517572739545, "StateBufferConnector_ms": 0.003842746510225184, "ViewRequirementAgentConnector_ms": 0.3080999149995692}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 207.84574959179966, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 628000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 19525.348, "sample_time_ms": 11125.522, "synch_weights_time_ms": 2.28}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 157, "trial_id": "ea782_00000", "date": "2024-07-15_18-55-00", "timestamp": 1721062500, "time_this_iter_s": 19.24750256538391, "time_total_s": 2583.415315389633, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2583.415315389633, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 9.518518518518519, "ram_util_percent": 77.84814814814816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.10291114808427596}, "default_policy": {"total_loss": 0.10291114808427596, "policy_loss": 0.01921800112682901, "vf_loss": 2.699775168286966, "vf_loss_unclipped": 3.120883031726392, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.031193440593382, "mean_kl_loss": 0.03495768568711107, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 208.55238230270913, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 632000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 19553.211, "sample_time_ms": 11166.716, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 158, "trial_id": "ea782_00000", "date": "2024-07-15_18-55-19", "timestamp": 1721062519, "time_this_iter_s": 19.182387351989746, "time_total_s": 2602.597702741623, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2602.597702741623, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 9.360714285714286, "ram_util_percent": 77.80714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04157021244280914}, "default_policy": {"total_loss": 0.04157021244280914, "policy_loss": 0.00043304634741199677, "vf_loss": 2.4880289209168605, "vf_loss_unclipped": 2.789772407967907, "vf_explained_var": -9.546910267648921e-07, "entropy": 0.9367082064339856, "mean_kl_loss": 0.0066825276963523965, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.0008657287923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 636000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 19360.794, "sample_time_ms": 11058.945, "synch_weights_time_ms": 2.293}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 159, "trial_id": "ea782_00000", "date": "2024-07-15_18-55-38", "timestamp": 1721062538, "time_this_iter_s": 18.435272932052612, "time_total_s": 2621.0329756736755, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2621.0329756736755, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 8.538461538461538, "ram_util_percent": 77.8423076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05751728040919796}, "default_policy": {"total_loss": 0.05751728040919796, "policy_loss": 0.0014958825460803914, "vf_loss": 3.1413083796435073, "vf_loss_unclipped": 4.390696221005434, "vf_explained_var": -9.548181155597222e-07, "entropy": 0.891046011498742, "mean_kl_loss": 0.010115457866236003, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 208.87012713088797, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 640000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 19223.617, "sample_time_ms": 10942.592, "synch_weights_time_ms": 2.315}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 160, "trial_id": "ea782_00000", "date": "2024-07-15_18-55-57", "timestamp": 1721062557, "time_this_iter_s": 19.1537868976593, "time_total_s": 2640.186762571335, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2640.186762571335, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 9.177777777777779, "ram_util_percent": 77.90370370370373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06537148400471965}, "default_policy": {"total_loss": 0.06537148400471965, "policy_loss": 0.0011457536292117415, "vf_loss": 4.9543725511412635, "vf_loss_unclipped": 8.584747839329848, "vf_explained_var": -9.564702698925156e-07, "entropy": 0.871280184623275, "mean_kl_loss": 0.006035163662785023, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 196.70193362534232, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 644000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 19274.932, "sample_time_ms": 10986.546, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 161, "trial_id": "ea782_00000", "date": "2024-07-15_18-56-17", "timestamp": 1721062577, "time_this_iter_s": 20.33779764175415, "time_total_s": 2660.524560213089, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2660.524560213089, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 9.168965517241379, "ram_util_percent": 77.97586206896553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07853905791476337}, "default_policy": {"total_loss": 0.07853905791476337, "policy_loss": 0.0022815486737914176, "vf_loss": 5.23145980278312, "vf_loss_unclipped": 9.285539403398916, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.904146809122964, "mean_kl_loss": 0.009841936126540066, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.15428641830758, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 648000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 19101.064, "sample_time_ms": 10894.798, "synch_weights_time_ms": 2.345}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 162, "trial_id": "ea782_00000", "date": "2024-07-15_18-56-36", "timestamp": 1721062596, "time_this_iter_s": 18.680235385894775, "time_total_s": 2679.2047955989838, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2679.2047955989838, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 8.844444444444443, "ram_util_percent": 78.0925925925926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07117353596522022}, "default_policy": {"total_loss": 0.07117353596522022, "policy_loss": 0.0031219424177477482, "vf_loss": 4.827835140324859, "vf_loss_unclipped": 10.18734450330104, "vf_explained_var": -9.544368491752315e-07, "entropy": 0.9756891262937964, "mean_kl_loss": 0.008127959883382876, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 204.52639351880697, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 652000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 19190.339, "sample_time_ms": 10920.657, "synch_weights_time_ms": 2.293}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "ea782_00000", "date": "2024-07-15_18-56-55", "timestamp": 1721062615, "time_this_iter_s": 19.5600004196167, "time_total_s": 2698.7647960186005, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2698.7647960186005, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 9.128571428571428, "ram_util_percent": 78.02499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05909245145588573}, "default_policy": {"total_loss": 0.05909245145588573, "policy_loss": -0.002402968003602226, "vf_loss": 3.835203797069948, "vf_loss_unclipped": 6.530239048034652, "vf_explained_var": -9.535472276114198e-07, "entropy": 1.0562620010457313, "mean_kl_loss": 0.009513283523530869, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 209.43627015745093, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 656000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 19186.309, "sample_time_ms": 10906.7, "synch_weights_time_ms": 2.278}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "ea782_00000", "date": "2024-07-15_18-57-15", "timestamp": 1721062635, "time_this_iter_s": 19.101017713546753, "time_total_s": 2717.865813732147, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2717.865813732147, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 8.78888888888889, "ram_util_percent": 78.0074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.055617996106253884}, "default_policy": {"total_loss": 0.055617996106253884, "policy_loss": 0.0007423934688581142, "vf_loss": 3.914900034475428, "vf_loss_unclipped": 5.677551120074828, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.1404746151936334, "mean_kl_loss": 0.006464553517296906, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 199.60522290555195, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 660000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 19242.641, "sample_time_ms": 10958.622, "synch_weights_time_ms": 2.258}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "ea782_00000", "date": "2024-07-15_18-57-35", "timestamp": 1721062655, "time_this_iter_s": 20.041801691055298, "time_total_s": 2737.9076154232025, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2737.9076154232025, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 9.014285714285714, "ram_util_percent": 78.06071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05758529036804271}, "default_policy": {"total_loss": 0.05758529036804271, "policy_loss": 0.004561602877679346, "vf_loss": 2.1630703496145034, "vf_loss_unclipped": 2.429242780531393, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.1846044050223792, "mean_kl_loss": 0.012904352510998548, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -9986.277777777777, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45698579177406234, "mean_inference_ms": 1.1426308388746256, "mean_action_processing_ms": 0.11948511681848356, "mean_env_wait_ms": 0.9524360911373674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00680949952867296, "StateBufferConnector_ms": 0.0038054254319932726, "ViewRequirementAgentConnector_ms": 0.30534002516004777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 195.57082147022206, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 664000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 19417.058, "sample_time_ms": 11036.21, "synch_weights_time_ms": 2.29}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 166, "trial_id": "ea782_00000", "date": "2024-07-15_18-57-55", "timestamp": 1721062675, "time_this_iter_s": 20.45485520362854, "time_total_s": 2758.362470626831, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2758.362470626831, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 13.300000000000002, "ram_util_percent": 78.62666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06022240083700896}, "default_policy": {"total_loss": 0.06022240083700896, "policy_loss": 0.0014953264144501452, "vf_loss": 3.88807483370116, "vf_loss_unclipped": 5.53609013354092, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.2330432628263543, "mean_kl_loss": 0.008158001587940887, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 207.69323367751758, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 668000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 19418.471, "sample_time_ms": 11083.833, "synch_weights_time_ms": 2.319}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 167, "trial_id": "ea782_00000", "date": "2024-07-15_18-58-14", "timestamp": 1721062694, "time_this_iter_s": 19.261918306350708, "time_total_s": 2777.6243889331818, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2777.6243889331818, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 8.751851851851852, "ram_util_percent": 79.17777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05004143796618909}, "default_policy": {"total_loss": 0.05004143796618909, "policy_loss": 0.0032510320126795883, "vf_loss": 2.9364057907671817, "vf_loss_unclipped": 3.97297035974226, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.1836783729636593, "mean_kl_loss": 0.007163247627216448, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.955077725739, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 672000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 19344.188, "sample_time_ms": 11016.054, "synch_weights_time_ms": 2.344}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 168, "trial_id": "ea782_00000", "date": "2024-07-15_18-58-33", "timestamp": 1721062713, "time_this_iter_s": 18.439635276794434, "time_total_s": 2796.064024209976, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2796.064024209976, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 8.66923076923077, "ram_util_percent": 79.06923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04430973300956555}, "default_policy": {"total_loss": 0.04430973300956555, "policy_loss": -0.0006898473173792937, "vf_loss": 3.0969887112757797, "vf_loss_unclipped": 4.660813316607526, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.198012238626541, "mean_kl_loss": 0.005767026582189132, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.59936622819436, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 676000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 19364.816, "sample_time_ms": 11031.099, "synch_weights_time_ms": 2.339}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 169, "trial_id": "ea782_00000", "date": "2024-07-15_18-58-52", "timestamp": 1721062732, "time_this_iter_s": 18.64169955253601, "time_total_s": 2814.705723762512, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2814.705723762512, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 8.42962962962963, "ram_util_percent": 79.09629629629627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06127120296248415}, "default_policy": {"total_loss": 0.06127120296248415, "policy_loss": 0.00028667133102920265, "vf_loss": 4.519098604030447, "vf_loss_unclipped": 9.351353005178447, "vf_explained_var": -9.534201388165895e-07, "entropy": 1.2156109809875488, "mean_kl_loss": 0.006492072090898338, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.92584333992178, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 680000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 19310.856, "sample_time_ms": 11048.415, "synch_weights_time_ms": 2.326}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 170, "trial_id": "ea782_00000", "date": "2024-07-15_18-59-10", "timestamp": 1721062750, "time_this_iter_s": 18.613221168518066, "time_total_s": 2833.3189449310303, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2833.3189449310303, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 8.13076923076923, "ram_util_percent": 79.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07955008236341861}, "default_policy": {"total_loss": 0.07955008236341861, "policy_loss": 0.0024783415089387187, "vf_loss": 5.77496547854023, "vf_loss_unclipped": 16.557688206370706, "vf_explained_var": -9.569786250718366e-07, "entropy": 1.185841937436224, "mean_kl_loss": 0.00794250686823734, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.07416545599548, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 684000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 19128.539, "sample_time_ms": 10927.904, "synch_weights_time_ms": 2.305}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 171, "trial_id": "ea782_00000", "date": "2024-07-15_18-59-29", "timestamp": 1721062769, "time_this_iter_s": 18.51451301574707, "time_total_s": 2851.8334579467773, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2851.8334579467773, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 8.333333333333334, "ram_util_percent": 79.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.072293129349465}, "default_policy": {"total_loss": 0.072293129349465, "policy_loss": -0.0033603607645151076, "vf_loss": 5.392045753342765, "vf_loss_unclipped": 10.64087283992564, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.1763228270163668, "mean_kl_loss": 0.008933546682094921, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.0989455143725, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 688000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 19078.092, "sample_time_ms": 10885.369, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 172, "trial_id": "ea782_00000", "date": "2024-07-15_18-59-47", "timestamp": 1721062787, "time_this_iter_s": 18.17613983154297, "time_total_s": 2870.0095977783203, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2870.0095977783203, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 8.146153846153846, "ram_util_percent": 79.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06931311374744659}, "default_policy": {"total_loss": 0.06931311374744659, "policy_loss": 0.0011636064338710294, "vf_loss": 4.815176059061022, "vf_loss_unclipped": 8.339838514958362, "vf_explained_var": -9.538014052010803e-07, "entropy": 1.1982536209163381, "mean_kl_loss": 0.008220243141339815, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.432744026184082}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.60650063208138, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 692000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 18986.231, "sample_time_ms": 10868.278, "synch_weights_time_ms": 2.337}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 173, "trial_id": "ea782_00000", "date": "2024-07-15_19-00-06", "timestamp": 1721062806, "time_this_iter_s": 18.641021013259888, "time_total_s": 2888.65061879158, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2888.65061879158, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 8.434615384615384, "ram_util_percent": 79.1076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04462207008554324}, "default_policy": {"total_loss": 0.04462207008554324, "policy_loss": -0.001573936874245498, "vf_loss": 3.4306656443742294, "vf_loss_unclipped": 5.09435522022532, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.1450616017714748, "mean_kl_loss": 0.0048872199437640824, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.48204380037416, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 696000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 18915.574, "sample_time_ms": 10850.979, "synch_weights_time_ms": 2.328}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 174, "trial_id": "ea782_00000", "date": "2024-07-15_19-00-24", "timestamp": 1721062824, "time_this_iter_s": 18.3943510055542, "time_total_s": 2907.0449697971344, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2907.0449697971344, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 8.484615384615385, "ram_util_percent": 79.13076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04978418162987153}, "default_policy": {"total_loss": 0.04978418162987153, "policy_loss": 0.003994279054563437, "vf_loss": 2.7871398904176155, "vf_loss_unclipped": 3.0544438012627397, "vf_explained_var": -9.517679844837962e-07, "entropy": 1.1395233999818628, "mean_kl_loss": 0.014731107647001095, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}}, "episode_reward_max": -8905.0, "episode_reward_min": -11984.0, "episode_reward_mean": -10055.78947368421, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45697027839506577, "mean_inference_ms": 1.1422090201021917, "mean_action_processing_ms": 0.11942869096024085, "mean_env_wait_ms": 0.9521635472623876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684504057231702, "StateBufferConnector_ms": 0.003765758715177837, "ViewRequirementAgentConnector_ms": 0.3042108134219521}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.80093908044458, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 700000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 18739.764, "sample_time_ms": 10737.472, "synch_weights_time_ms": 2.354}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 19, "training_iteration": 175, "trial_id": "ea782_00000", "date": "2024-07-15_19-00-42", "timestamp": 1721062842, "time_this_iter_s": 18.283811330795288, "time_total_s": 2925.3287811279297, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2925.3287811279297, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 8.426923076923076, "ram_util_percent": 79.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.052400464974919646}, "default_policy": {"total_loss": 0.052400464974919646, "policy_loss": 0.00466663999828512, "vf_loss": 2.732040682930682, "vf_loss_unclipped": 3.2673990091344693, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.2812605033805375, "mean_kl_loss": 0.016782218879400276, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.76714827936735, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 704000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 18565.663, "sample_time_ms": 10661.959, "synch_weights_time_ms": 2.309}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 176, "trial_id": "ea782_00000", "date": "2024-07-15_19-01-01", "timestamp": 1721062861, "time_this_iter_s": 18.714471578598022, "time_total_s": 2944.0432527065277, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2944.0432527065277, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 8.470370370370372, "ram_util_percent": 79.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0603035863301258}, "default_policy": {"total_loss": 0.0603035863301258, "policy_loss": 0.007311541318043526, "vf_loss": 3.0997737315036593, "vf_loss_unclipped": 3.966666665730446, "vf_explained_var": -9.530388724320987e-07, "entropy": 1.266580851093284, "mean_kl_loss": 0.018081895575871313, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.32495556437405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 708000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 18480.308, "sample_time_ms": 10597.247, "synch_weights_time_ms": 2.285}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 177, "trial_id": "ea782_00000", "date": "2024-07-15_19-01-19", "timestamp": 1721062879, "time_this_iter_s": 18.408032178878784, "time_total_s": 2962.4512848854065, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2962.4512848854065, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 8.48076923076923, "ram_util_percent": 78.94615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03821937096182819}, "default_policy": {"total_loss": 0.03821937096182819, "policy_loss": -0.0025205899994057823, "vf_loss": 3.132249786846165, "vf_loss_unclipped": 3.8784008946881365, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.3449894146624404, "mean_kl_loss": 0.007742259045361605, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.46289330575652, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 712000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 18510.468, "sample_time_ms": 10611.666, "synch_weights_time_ms": 2.281}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 178, "trial_id": "ea782_00000", "date": "2024-07-15_19-01-38", "timestamp": 1721062898, "time_this_iter_s": 18.740668535232544, "time_total_s": 2981.191953420639, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2981.191953420639, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 9.403703703703703, "ram_util_percent": 78.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07520050591807058}, "default_policy": {"total_loss": 0.07520050591807058, "policy_loss": 0.0076646043016497835, "vf_loss": 4.596060393969895, "vf_loss_unclipped": 7.570502354265022, "vf_explained_var": -9.57614069045988e-07, "entropy": 1.3841712904383126, "mean_kl_loss": 0.017737418217750798, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.46006925284195, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 716000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 18469.185, "sample_time_ms": 10576.193, "synch_weights_time_ms": 2.264}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 179, "trial_id": "ea782_00000", "date": "2024-07-15_19-01-56", "timestamp": 1721062916, "time_this_iter_s": 18.229246616363525, "time_total_s": 2999.4212000370026, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2999.4212000370026, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 8.688461538461537, "ram_util_percent": 79.08461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06661453341612461}, "default_policy": {"total_loss": 0.06661453341612461, "policy_loss": 0.00914234227524685, "vf_loss": 4.030145153435054, "vf_loss_unclipped": 9.07077097918179, "vf_explained_var": -9.574869802511577e-07, "entropy": 1.452004710621417, "mean_kl_loss": 0.014116359316048398, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.53272786683516, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 720000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 18438.468, "sample_time_ms": 10547.453, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 180, "trial_id": "ea782_00000", "date": "2024-07-15_19-02-15", "timestamp": 1721062935, "time_this_iter_s": 18.306497812271118, "time_total_s": 3017.7276978492737, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3017.7276978492737, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 8.588461538461539, "ram_util_percent": 79.16153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04383624202039625}, "default_policy": {"total_loss": 0.04383624202039625, "policy_loss": -0.0008570768379929986, "vf_loss": 3.2464399619270234, "vf_loss_unclipped": 4.498900535518427, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.3319530830200292, "mean_kl_loss": 0.010053602081612061, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.52943058551634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 724000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 18409.331, "sample_time_ms": 10527.333, "synch_weights_time_ms": 2.245}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "ea782_00000", "date": "2024-07-15_19-02-33", "timestamp": 1721062953, "time_this_iter_s": 18.22340178489685, "time_total_s": 3035.9510996341705, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3035.9510996341705, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 8.542307692307691, "ram_util_percent": 79.2576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.046815127957793974}, "default_policy": {"total_loss": 0.046815127957793974, "policy_loss": 0.002747855370373789, "vf_loss": 2.411296786593476, "vf_loss_unclipped": 2.891992145065051, "vf_explained_var": -9.550722931493829e-07, "entropy": 1.3302054381065531, "mean_kl_loss": 0.016404773774217375, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.216372013092041}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.275548467172, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 728000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 18407.874, "sample_time_ms": 10518.316, "synch_weights_time_ms": 2.243}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 182, "trial_id": "ea782_00000", "date": "2024-07-15_19-02-51", "timestamp": 1721062971, "time_this_iter_s": 18.16122078895569, "time_total_s": 3054.112320423126, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3054.112320423126, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 8.299999999999999, "ram_util_percent": 79.27307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07706947809955014}, "default_policy": {"total_loss": 0.07706947809955014, "policy_loss": -0.000920108128299337, "vf_loss": 4.873497275337736, "vf_loss_unclipped": 14.57410070541571, "vf_explained_var": -9.582495130201392e-07, "entropy": 1.3287510059789809, "mean_kl_loss": 0.02405071423533854, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10178.8, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45694989671181546, "mean_inference_ms": 1.1417591903541169, "mean_action_processing_ms": 0.11937041429132204, "mean_env_wait_ms": 0.9519578800070043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006575584411621094, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.3028249740600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.53479831242782, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 732000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 18382.784, "sample_time_ms": 10489.736, "synch_weights_time_ms": 2.242}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 183, "trial_id": "ea782_00000", "date": "2024-07-15_19-03-10", "timestamp": 1721062990, "time_this_iter_s": 18.390019416809082, "time_total_s": 3072.5023398399353, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3072.5023398399353, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 8.200000000000001, "ram_util_percent": 79.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07195837108610964}, "default_policy": {"total_loss": 0.07195837108610964, "policy_loss": 0.003808143344133902, "vf_loss": 5.281402700491297, "vf_loss_unclipped": 10.769957325605949, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.2761869017503409, "mean_kl_loss": 0.00840543475292344, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.49717590877802, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 736000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 18408.377, "sample_time_ms": 10510.237, "synch_weights_time_ms": 2.248}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 184, "trial_id": "ea782_00000", "date": "2024-07-15_19-03-28", "timestamp": 1721063008, "time_this_iter_s": 18.650403261184692, "time_total_s": 3091.15274310112, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3091.15274310112, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 8.26153846153846, "ram_util_percent": 79.30384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06781009219582877}, "default_policy": {"total_loss": 0.06781009219582877, "policy_loss": 0.0002590160467413697, "vf_loss": 5.593139647039523, "vf_loss_unclipped": 12.809880216619861, "vf_explained_var": -9.543097603804014e-07, "entropy": 1.3969052258585053, "mean_kl_loss": 0.006368492253285809, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.49904048087424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 740000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 18402.562, "sample_time_ms": 10491.938, "synch_weights_time_ms": 2.242}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 185, "trial_id": "ea782_00000", "date": "2024-07-15_19-03-47", "timestamp": 1721063027, "time_this_iter_s": 18.225304126739502, "time_total_s": 3109.3780472278595, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3109.3780472278595, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 8.299999999999999, "ram_util_percent": 79.3076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.056152931053135825}, "default_policy": {"total_loss": 0.056152931053135825, "policy_loss": -0.00015465809858398143, "vf_loss": 4.446679934192059, "vf_loss_unclipped": 6.298676717700735, "vf_explained_var": -9.550722931493829e-07, "entropy": 1.4579180594700485, "mean_kl_loss": 0.00648967535776108, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.01964167397148, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 744000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 18374.52, "sample_time_ms": 10458.245, "synch_weights_time_ms": 2.23}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 186, "trial_id": "ea782_00000", "date": "2024-07-15_19-04-05", "timestamp": 1721063045, "time_this_iter_s": 18.433461666107178, "time_total_s": 3127.8115088939667, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3127.8115088939667, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 8.518518518518519, "ram_util_percent": 79.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.067336917491451}, "default_policy": {"total_loss": 0.067336917491451, "policy_loss": 0.004120607048705983, "vf_loss": 3.0597792114021938, "vf_loss_unclipped": 3.526167787722687, "vf_explained_var": -9.540555827907407e-07, "entropy": 1.523338589078582, "mean_kl_loss": 0.017877492094458367, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.4133221691278, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 748000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 18382.273, "sample_time_ms": 10469.468, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 187, "trial_id": "ea782_00000", "date": "2024-07-15_19-04-24", "timestamp": 1721063064, "time_this_iter_s": 18.485177040100098, "time_total_s": 3146.2966859340668, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3146.2966859340668, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 8.23846153846154, "ram_util_percent": 79.40384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.045914184666727226}, "default_policy": {"total_loss": 0.045914184666727226, "policy_loss": 0.0037279344821122408, "vf_loss": 2.941251807026009, "vf_loss_unclipped": 3.9732972380004203, "vf_explained_var": -9.565973586873459e-07, "entropy": 1.38340896762002, "mean_kl_loss": 0.007001002467096424, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.7507144849001, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 752000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 18312.239, "sample_time_ms": 10422.197, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 188, "trial_id": "ea782_00000", "date": "2024-07-15_19-04-42", "timestamp": 1721063082, "time_this_iter_s": 18.04074740409851, "time_total_s": 3164.3374333381653, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3164.3374333381653, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 8.542307692307691, "ram_util_percent": 79.42692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.043941731264354036}, "default_policy": {"total_loss": 0.043941731264354036, "policy_loss": -0.0013925586772490857, "vf_loss": 3.3592432964203964, "vf_loss_unclipped": 5.917685062074458, "vf_explained_var": -9.54182671585571e-07, "entropy": 1.3520482839551815, "mean_kl_loss": 0.006435452822646038, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.97337224947012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 756000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 18307.986, "sample_time_ms": 10420.833, "synch_weights_time_ms": 2.266}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 189, "trial_id": "ea782_00000", "date": "2024-07-15_19-05-00", "timestamp": 1721063100, "time_this_iter_s": 18.186651945114136, "time_total_s": 3182.5240852832794, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3182.5240852832794, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 8.596, "ram_util_percent": 79.13599999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05261975786646705}, "default_policy": {"total_loss": 0.05261975786646705, "policy_loss": 0.0016252623423179393, "vf_loss": 3.0125994948563037, "vf_loss_unclipped": 3.5048853943724114, "vf_explained_var": -9.530388724320987e-07, "entropy": 1.3923235508932996, "mean_kl_loss": 0.011437566434677192, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 221.572666803295, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 760000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 18282.874, "sample_time_ms": 10400.366, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 190, "trial_id": "ea782_00000", "date": "2024-07-15_19-05-18", "timestamp": 1721063118, "time_this_iter_s": 18.054933786392212, "time_total_s": 3200.5790190696716, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3200.5790190696716, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 8.661538461538461, "ram_util_percent": 79.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04136998440448775}, "default_policy": {"total_loss": 0.04136998440448775, "policy_loss": 0.0011532710292247504, "vf_loss": 2.415452148836813, "vf_loss_unclipped": 2.7107060898913504, "vf_explained_var": -9.545639379700618e-07, "entropy": 1.3434887706343808, "mean_kl_loss": 0.008803335240473529, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.95143359010018, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 764000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 18287.682, "sample_time_ms": 10390.518, "synch_weights_time_ms": 2.332}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 191, "trial_id": "ea782_00000", "date": "2024-07-15_19-05-36", "timestamp": 1721063136, "time_this_iter_s": 18.27113914489746, "time_total_s": 3218.850158214569, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3218.850158214569, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 8.692307692307692, "ram_util_percent": 79.13846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06504787596167008}, "default_policy": {"total_loss": 0.06504787596167008, "policy_loss": -0.0015183031630477926, "vf_loss": 5.351878261451782, "vf_loss_unclipped": 12.254230790745728, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.2676165528388927, "mean_kl_loss": 0.007150989676292525, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10188.238095238095, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4569197212171755, "mean_inference_ms": 1.1412888717464298, "mean_action_processing_ms": 0.11930949737822305, "mean_env_wait_ms": 0.9517468027795188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064690907796223955, "StateBufferConnector_ms": 0.003692081996372768, "ViewRequirementAgentConnector_ms": 0.3022534506661551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 220.8134379613437, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 768000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 18283.258, "sample_time_ms": 10391.01, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 192, "trial_id": "ea782_00000", "date": "2024-07-15_19-05-54", "timestamp": 1721063154, "time_this_iter_s": 18.117520093917847, "time_total_s": 3236.967678308487, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3236.967678308487, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 8.503846153846153, "ram_util_percent": 79.12692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08403108571246484}, "default_policy": {"total_loss": 0.08403108571246484, "policy_loss": -0.0023144038690964997, "vf_loss": 6.397055902015934, "vf_loss_unclipped": 18.102155085502147, "vf_explained_var": -9.548181155597222e-07, "entropy": 1.2376033240544009, "mean_kl_loss": 0.012263206892082396, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.14765794623156, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 772000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 18321.106, "sample_time_ms": 10434.615, "synch_weights_time_ms": 2.289}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 193, "trial_id": "ea782_00000", "date": "2024-07-15_19-06-13", "timestamp": 1721063173, "time_this_iter_s": 18.76921558380127, "time_total_s": 3255.736893892288, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3255.736893892288, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 8.525925925925927, "ram_util_percent": 79.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05765718625987377}, "default_policy": {"total_loss": 0.05765718625987377, "policy_loss": -0.00024385475911009412, "vf_loss": 4.6079917052534345, "vf_loss_unclipped": 7.047837493961046, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.1818788547251524, "mean_kl_loss": 0.006478897968755423, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.8245580196380615}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.85289963828802, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 776000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 18300.848, "sample_time_ms": 10418.69, "synch_weights_time_ms": 2.281}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 194, "trial_id": "ea782_00000", "date": "2024-07-15_19-06-32", "timestamp": 1721063192, "time_this_iter_s": 18.44774341583252, "time_total_s": 3274.1846373081207, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3274.1846373081207, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 8.849999999999998, "ram_util_percent": 79.21153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08556303334062987}, "default_policy": {"total_loss": 0.08556303334062987, "policy_loss": 0.01201912461058187, "vf_loss": 3.0949723974092684, "vf_loss_unclipped": 3.7910022606600577, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.1751876214165677, "mean_kl_loss": 0.023344936225967762, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.7368369102478027}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.30209625370674, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 780000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 18319.272, "sample_time_ms": 10437.344, "synch_weights_time_ms": 2.267}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 195, "trial_id": "ea782_00000", "date": "2024-07-15_19-06-50", "timestamp": 1721063210, "time_this_iter_s": 18.410524606704712, "time_total_s": 3292.5951619148254, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3292.5951619148254, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 79.29230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.039553195673740035}, "default_policy": {"total_loss": 0.039553195673740035, "policy_loss": 0.0010003215267952443, "vf_loss": 2.4914252419334484, "vf_loss_unclipped": 2.998644050441063, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.2233774011323193, "mean_kl_loss": 0.004983354190966786, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3684184551239014}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.4029755222585, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 784000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 18307.598, "sample_time_ms": 10432.299, "synch_weights_time_ms": 2.275}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 196, "trial_id": "ea782_00000", "date": "2024-07-15_19-07-08", "timestamp": 1721063228, "time_this_iter_s": 18.317099571228027, "time_total_s": 3310.9122614860535, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3310.9122614860535, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 8.588461538461539, "ram_util_percent": 79.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04864271395136791}, "default_policy": {"total_loss": 0.04864271395136791, "policy_loss": 0.004253679802561842, "vf_loss": 3.078877464159211, "vf_loss_unclipped": 3.981079703836299, "vf_explained_var": -9.534201388165895e-07, "entropy": 1.138510451832814, "mean_kl_loss": 0.00993867106810793, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3684184551239014}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.27756021209223, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 788000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 18291.812, "sample_time_ms": 10407.904, "synch_weights_time_ms": 2.234}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 197, "trial_id": "ea782_00000", "date": "2024-07-15_19-07-27", "timestamp": 1721063247, "time_this_iter_s": 18.328229904174805, "time_total_s": 3329.2404913902283, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3329.2404913902283, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 8.669230769230769, "ram_util_percent": 79.33076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.048384077251275213}, "default_policy": {"total_loss": 0.048384077251275213, "policy_loss": -0.0009500873880758723, "vf_loss": 3.218208279691017, "vf_loss_unclipped": 5.796141373069047, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.0915188281012496, "mean_kl_loss": 0.012534238827651364, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3684184551239014}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.33551700479046, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 792000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 18287.067, "sample_time_ms": 10411.118, "synch_weights_time_ms": 2.239}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 198, "trial_id": "ea782_00000", "date": "2024-07-15_19-07-45", "timestamp": 1721063265, "time_this_iter_s": 17.993038415908813, "time_total_s": 3347.233529806137, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3347.233529806137, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 8.615384615384615, "ram_util_percent": 79.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06327446229728077}, "default_policy": {"total_loss": 0.06327446229728077, "policy_loss": 0.012008447090346517, "vf_loss": 2.207130908553026, "vf_loss_unclipped": 2.552681867343022, "vf_explained_var": -9.55707737123534e-07, "entropy": 0.8985524821256016, "mean_kl_loss": 0.02133463707795716, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.23203902575904, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 796000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 18268.585, "sample_time_ms": 10392.486, "synch_weights_time_ms": 2.264}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 199, "trial_id": "ea782_00000", "date": "2024-07-15_19-08-03", "timestamp": 1721063283, "time_this_iter_s": 18.00101637840271, "time_total_s": 3365.23454618454, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3365.23454618454, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 8.357692307692307, "ram_util_percent": 79.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04478108622074159}, "default_policy": {"total_loss": 0.04478108622074159, "policy_loss": 0.0023556653594375768, "vf_loss": 2.556686732782992, "vf_loss_unclipped": 4.222857860836393, "vf_explained_var": -9.54182671585571e-07, "entropy": 0.9403345724031615, "mean_kl_loss": 0.008213159828060822, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 222.64378802169017, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 18259.9, "sample_time_ms": 10385.06, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 200, "trial_id": "ea782_00000", "date": "2024-07-15_19-08-21", "timestamp": 1721063301, "time_this_iter_s": 17.96799635887146, "time_total_s": 3383.2025425434113, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3383.2025425434113, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 8.316, "ram_util_percent": 79.47200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0915108560931994}, "default_policy": {"total_loss": 0.0915108560931994, "policy_loss": 0.002236264991635548, "vf_loss": 6.197483743622359, "vf_loss_unclipped": 19.18264585244122, "vf_explained_var": -9.54182671585571e-07, "entropy": 1.0570854904300877, "mean_kl_loss": 0.013299905753818337, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10209.863636363636, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45687996153188154, "mean_inference_ms": 1.1407890039867776, "mean_action_processing_ms": 0.1192455393661085, "mean_env_wait_ms": 0.9515046468478844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066627155650745735, "StateBufferConnector_ms": 0.0036564740267666903, "ViewRequirementAgentConnector_ms": 0.3013935956087979}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.2430765843568, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 804000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 18257.472, "sample_time_ms": 10395.555, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 201, "trial_id": "ea782_00000", "date": "2024-07-15_19-08-39", "timestamp": 1721063319, "time_this_iter_s": 18.247163772583008, "time_total_s": 3401.4497063159943, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3401.4497063159943, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 8.534615384615385, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0728431482132135}, "default_policy": {"total_loss": 0.0728431482132135, "policy_loss": 0.0007416143256829365, "vf_loss": 5.262762696376996, "vf_loss_unclipped": 14.420590250603935, "vf_explained_var": -9.550722931493829e-07, "entropy": 0.9913889036249759, "mean_kl_loss": 0.009487306764221508, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.420157935244, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 808000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 18320.224, "sample_time_ms": 10429.059, "synch_weights_time_ms": 2.221}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 202, "trial_id": "ea782_00000", "date": "2024-07-15_19-08-58", "timestamp": 1721063338, "time_this_iter_s": 18.74485468864441, "time_total_s": 3420.1945610046387, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3420.1945610046387, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 8.662962962962963, "ram_util_percent": 79.5074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09280267995057394}, "default_policy": {"total_loss": 0.09280267995057394, "policy_loss": 0.003159324457841133, "vf_loss": 5.081984532794464, "vf_loss_unclipped": 8.223825114876476, "vf_explained_var": -9.567244474821762e-07, "entropy": 0.9262942648264391, "mean_kl_loss": 0.018914055122039728, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 207.13960543209677, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 812000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 18374.655, "sample_time_ms": 10463.52, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 203, "trial_id": "ea782_00000", "date": "2024-07-15_19-09-17", "timestamp": 1721063357, "time_this_iter_s": 19.312795400619507, "time_total_s": 3439.507356405258, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3439.507356405258, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 8.592592592592593, "ram_util_percent": 79.57037037037036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08386999400836953}, "default_policy": {"total_loss": 0.08386999400836953, "policy_loss": 0.00808114064847435, "vf_loss": 4.155505914423766, "vf_loss_unclipped": 6.70454227390574, "vf_explained_var": -9.538014052010803e-07, "entropy": 1.053998839880612, "mean_kl_loss": 0.016678036657875147, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 201.07507442810058, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 816000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 18519.393, "sample_time_ms": 10526.11, "synch_weights_time_ms": 2.224}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 204, "trial_id": "ea782_00000", "date": "2024-07-15_19-09-37", "timestamp": 1721063377, "time_this_iter_s": 19.895918607711792, "time_total_s": 3459.40327501297, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3459.40327501297, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 10.410344827586206, "ram_util_percent": 79.00689655172411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.045840001724628626}, "default_policy": {"total_loss": 0.045840001724628626, "policy_loss": 0.0020743071728113937, "vf_loss": 2.6418042328439033, "vf_loss_unclipped": 2.994161939379503, "vf_explained_var": -9.567244474821762e-07, "entropy": 1.012411456372438, "mean_kl_loss": 0.00845143692127974, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 205.6524862908586, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 820000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 18623.665, "sample_time_ms": 10575.243, "synch_weights_time_ms": 2.29}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 205, "trial_id": "ea782_00000", "date": "2024-07-15_19-09-57", "timestamp": 1721063397, "time_this_iter_s": 19.45356845855713, "time_total_s": 3478.856843471527, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3478.856843471527, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 9.167857142857143, "ram_util_percent": 79.25357142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07210905391917523}, "default_policy": {"total_loss": 0.07210905391917523, "policy_loss": 0.007144850508959245, "vf_loss": 3.4526242493058064, "vf_loss_unclipped": 6.352611802152987, "vf_explained_var": -9.559619147131947e-07, "entropy": 1.1021724579685024, "mean_kl_loss": 0.014828782494384438, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.0526275634765625}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 205.97648730769876, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 824000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 18734.157, "sample_time_ms": 10614.214, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 206, "trial_id": "ea782_00000", "date": "2024-07-15_19-10-16", "timestamp": 1721063416, "time_this_iter_s": 19.421953916549683, "time_total_s": 3498.278797388077, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3498.278797388077, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 9.303703703703704, "ram_util_percent": 79.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.032951515922044865}, "default_policy": {"total_loss": 0.032951515922044865, "policy_loss": 4.055230979567398e-05, "vf_loss": 2.591698823834279, "vf_loss_unclipped": 3.6192637919617106, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.20066789180231, "mean_kl_loss": 0.00340732981756539, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0263137817382812}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 201.16310513515182, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 828000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 18890.066, "sample_time_ms": 10692.483, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 207, "trial_id": "ea782_00000", "date": "2024-07-15_19-10-36", "timestamp": 1721063436, "time_this_iter_s": 19.887306928634644, "time_total_s": 3518.1661043167114, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3518.1661043167114, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 8.917857142857143, "ram_util_percent": 79.47500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.03962547009163447}, "default_policy": {"total_loss": 0.03962547009163447, "policy_loss": 0.0024369742710397507, "vf_loss": 2.26885960808695, "vf_loss_unclipped": 2.7197882113680403, "vf_explained_var": -9.564702698925156e-07, "entropy": 1.2107275758724985, "mean_kl_loss": 0.014128139543764599, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0263137817382812}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 205.13598529896856, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 832000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 19040.908, "sample_time_ms": 10800.601, "synch_weights_time_ms": 2.338}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 208, "trial_id": "ea782_00000", "date": "2024-07-15_19-10-55", "timestamp": 1721063455, "time_this_iter_s": 19.501439094543457, "time_total_s": 3537.667543411255, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3537.667543411255, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 8.767857142857142, "ram_util_percent": 79.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04771873027856734}, "default_policy": {"total_loss": 0.04771873027856734, "policy_loss": 0.004200659933557579, "vf_loss": 2.9463221676059876, "vf_loss_unclipped": 3.901382920330267, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.1496611228629725, "mean_kl_loss": 0.01369449986495015, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0263137817382812}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 211.20201200403054, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 836000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 19134.909, "sample_time_ms": 10859.988, "synch_weights_time_ms": 2.33}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 209, "trial_id": "ea782_00000", "date": "2024-07-15_19-11-14", "timestamp": 1721063474, "time_this_iter_s": 18.941593408584595, "time_total_s": 3556.6091368198395, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3556.6091368198395, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 8.31111111111111, "ram_util_percent": 79.0037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.09342070417935407}, "default_policy": {"total_loss": 0.09342070417935407, "policy_loss": 0.00759758269027082, "vf_loss": 6.285946047382314, "vf_loss_unclipped": 18.58888809678397, "vf_explained_var": -9.549452043545526e-07, "entropy": 1.2079478475584913, "mean_kl_loss": 0.02237489044008879, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10207.08695652174, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568320511309582, "mean_inference_ms": 1.1402687061936156, "mean_action_processing_ms": 0.11917919256759862, "mean_env_wait_ms": 0.9512342022952499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065824259882387905, "StateBufferConnector_ms": 0.0036353650300399117, "ViewRequirementAgentConnector_ms": 0.3015030985293181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 208.79629273557805, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 840000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 19254.06, "sample_time_ms": 10953.603, "synch_weights_time_ms": 2.379}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 210, "trial_id": "ea782_00000", "date": "2024-07-15_19-11-34", "timestamp": 1721063494, "time_this_iter_s": 19.160431385040283, "time_total_s": 3575.7695682048798, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3575.7695682048798, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 9.107142857142858, "ram_util_percent": 79.0642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06609321459889539}, "default_policy": {"total_loss": 0.06609321459889539, "policy_loss": -0.0013049728259928763, "vf_loss": 4.631369397266587, "vf_loss_unclipped": 13.731167226521444, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.2497682092286377, "mean_kl_loss": 0.013695936356579314, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 202.09904202408578, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 844000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 19408.827, "sample_time_ms": 11064.772, "synch_weights_time_ms": 2.395}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 211, "trial_id": "ea782_00000", "date": "2024-07-15_19-11-53", "timestamp": 1721063513, "time_this_iter_s": 19.794715642929077, "time_total_s": 3595.564283847809, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3595.564283847809, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 9.45, "ram_util_percent": 79.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05421591099244413}, "default_policy": {"total_loss": 0.05421591099244413, "policy_loss": -0.000710638998540988, "vf_loss": 4.262525554468382, "vf_loss_unclipped": 7.077086664529752, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.2918180782657696, "mean_kl_loss": 0.007990599868556996, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 202.83832412315084, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 848000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 19506.605, "sample_time_ms": 11123.56, "synch_weights_time_ms": 2.411}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 212, "trial_id": "ea782_00000", "date": "2024-07-15_19-12-13", "timestamp": 1721063533, "time_this_iter_s": 19.72228217124939, "time_total_s": 3615.2865660190582, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3615.2865660190582, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 9.075000000000001, "ram_util_percent": 79.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04014072143711023}, "default_policy": {"total_loss": 0.04014072143711023, "policy_loss": 0.003776866441735549, "vf_loss": 2.5720320331262374, "vf_loss_unclipped": 2.768436413583979, "vf_explained_var": -9.553264707390433e-07, "entropy": 1.2991677129954926, "mean_kl_loss": 0.006913765590667678, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 207.37764950367702, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 852000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 19504.389, "sample_time_ms": 11080.408, "synch_weights_time_ms": 2.407}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 213, "trial_id": "ea782_00000", "date": "2024-07-15_19-12-32", "timestamp": 1721063552, "time_this_iter_s": 19.290440559387207, "time_total_s": 3634.5770065784454, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3634.5770065784454, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 9.037037037037036, "ram_util_percent": 79.20740740740739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0413089238844667}, "default_policy": {"total_loss": 0.0413089238844667, "policy_loss": -0.0015076955284939202, "vf_loss": 3.33374529085688, "vf_loss_unclipped": 4.679127143008877, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.3363632083193326, "mean_kl_loss": 0.006157422995487444, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 202.92290614517324, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 856000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 19486.273, "sample_time_ms": 11065.702, "synch_weights_time_ms": 2.429}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 214, "trial_id": "ea782_00000", "date": "2024-07-15_19-12-52", "timestamp": 1721063572, "time_this_iter_s": 19.715380907058716, "time_total_s": 3654.292387485504, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3654.292387485504, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 9.485714285714286, "ram_util_percent": 79.39999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07097574223606373}, "default_policy": {"total_loss": 0.07097574223606373, "policy_loss": -0.001314500695281128, "vf_loss": 5.621904421716865, "vf_loss_unclipped": 15.453513207593199, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.3730625972818973, "mean_kl_loss": 0.010439433258174901, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 199.53156296078717, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 860000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 19545.941, "sample_time_ms": 11143.81, "synch_weights_time_ms": 2.363}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 215, "trial_id": "ea782_00000", "date": "2024-07-15_19-13-12", "timestamp": 1721063592, "time_this_iter_s": 20.049294233322144, "time_total_s": 3674.3416817188263, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3674.3416817188263, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 8.751724137931035, "ram_util_percent": 79.1413793103448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07616260261145799}, "default_policy": {"total_loss": 0.07616260261145799, "policy_loss": -0.000892381233447142, "vf_loss": 5.516844440434279, "vf_loss_unclipped": 14.203726103755711, "vf_explained_var": -9.549452043545526e-07, "entropy": 1.3326069769828812, "mean_kl_loss": 0.014216927499172458, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 201.96762593452914, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 864000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 19584.487, "sample_time_ms": 11183.123, "synch_weights_time_ms": 2.348}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 216, "trial_id": "ea782_00000", "date": "2024-07-15_19-13-32", "timestamp": 1721063612, "time_this_iter_s": 19.80787491798401, "time_total_s": 3694.1495566368103, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3694.1495566368103, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 8.667857142857143, "ram_util_percent": 78.9357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.056556583976428675}, "default_policy": {"total_loss": 0.056556583976428675, "policy_loss": -0.0012977967472639737, "vf_loss": 4.414614410923996, "vf_loss_unclipped": 7.7843753108337745, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.360492275340725, "mean_kl_loss": 0.008904514000823063, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 202.10852725579764, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 868000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 19575.185, "sample_time_ms": 11198.649, "synch_weights_time_ms": 2.348}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 217, "trial_id": "ea782_00000", "date": "2024-07-15_19-13-52", "timestamp": 1721063632, "time_this_iter_s": 19.793418407440186, "time_total_s": 3713.9429750442505, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3713.9429750442505, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 8.717857142857143, "ram_util_percent": 78.90357142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04520976211009885}, "default_policy": {"total_loss": 0.04520976211009885, "policy_loss": -0.0013465872798949035, "vf_loss": 3.2728052699108368, "vf_loss_unclipped": 3.888412226682533, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.3002429934961202, "mean_kl_loss": 0.00898250230990415, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10228.625, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568085339652588, "mean_inference_ms": 1.1399167073413496, "mean_action_processing_ms": 0.11913526299860337, "mean_env_wait_ms": 0.9510323119518299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552537282307942, "StateBufferConnector_ms": 0.00372926394144694, "ViewRequirementAgentConnector_ms": 0.30118922392527264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 204.50340515665695, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 872000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 19581.218, "sample_time_ms": 11178.348, "synch_weights_time_ms": 2.402}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 218, "trial_id": "ea782_00000", "date": "2024-07-15_19-14-11", "timestamp": 1721063651, "time_this_iter_s": 19.561581134796143, "time_total_s": 3733.5045561790466, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3733.5045561790466, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 8.175, "ram_util_percent": 78.99285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.050221692322930105}, "default_policy": {"total_loss": 0.050221692322930105, "policy_loss": 0.002433792589657279, "vf_loss": 2.7463511962816916, "vf_loss_unclipped": 3.2621712704647834, "vf_explained_var": -9.563431810976854e-07, "entropy": 1.2542013384894268, "mean_kl_loss": 0.013202192945134536, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5394706726074219}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 211.56028067585837, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 876000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 19578.011, "sample_time_ms": 11190.059, "synch_weights_time_ms": 2.452}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 219, "trial_id": "ea782_00000", "date": "2024-07-15_19-14-30", "timestamp": 1721063670, "time_this_iter_s": 18.909612894058228, "time_total_s": 3752.414169073105, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3752.414169073105, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 8.355555555555556, "ram_util_percent": 79.03333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06928739083339093}, "default_policy": {"total_loss": 0.06928739083339093, "policy_loss": 0.013285684690220968, "vf_loss": 2.3318652548769645, "vf_loss_unclipped": 2.661082704819596, "vf_explained_var": -9.532930500217593e-07, "entropy": 1.1229345572909821, "mean_kl_loss": 0.021230060536793417, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.34872534693488, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 880000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 19519.72, "sample_time_ms": 11142.242, "synch_weights_time_ms": 2.418}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 220, "trial_id": "ea782_00000", "date": "2024-07-15_19-14-49", "timestamp": 1721063689, "time_this_iter_s": 18.576647758483887, "time_total_s": 3770.9908168315887, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3770.9908168315887, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 8.374074074074075, "ram_util_percent": 78.89259259259259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06387185309229217}, "default_policy": {"total_loss": 0.06387185309229217, "policy_loss": 0.003219878830230122, "vf_loss": 2.924538604931028, "vf_loss_unclipped": 4.084256925880274, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.0725120269794708, "mean_kl_loss": 0.013600601487470838, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.10587420462207, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 884000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 19400.043, "sample_time_ms": 11045.317, "synch_weights_time_ms": 2.443}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 221, "trial_id": "ea782_00000", "date": "2024-07-15_19-15-08", "timestamp": 1721063708, "time_this_iter_s": 18.597363233566284, "time_total_s": 3789.588180065155, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3789.588180065155, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 8.457692307692309, "ram_util_percent": 78.78076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04527353696666086}, "default_policy": {"total_loss": 0.04527353696666086, "policy_loss": 0.0015521219987144222, "vf_loss": 2.6793673238012072, "vf_loss_unclipped": 3.80385466997049, "vf_explained_var": -9.543097603804014e-07, "entropy": 1.0069492257225996, "mean_kl_loss": 0.007330548878021187, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.95972007548926, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 888000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 19288.842, "sample_time_ms": 10990.919, "synch_weights_time_ms": 2.448}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 222, "trial_id": "ea782_00000", "date": "2024-07-15_19-15-26", "timestamp": 1721063726, "time_this_iter_s": 18.610631227493286, "time_total_s": 3808.1988112926483, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3808.1988112926483, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 8.81851851851852, "ram_util_percent": 78.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06633633995371094}, "default_policy": {"total_loss": 0.06633633995371094, "policy_loss": 0.0016862816601268837, "vf_loss": 4.758468963761828, "vf_loss_unclipped": 7.7159024547539286, "vf_explained_var": -9.55199381944213e-07, "entropy": 1.0871611283277907, "mean_kl_loss": 0.007390146502971288, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.6812166373152, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 892000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 19223.222, "sample_time_ms": 10970.556, "synch_weights_time_ms": 2.463}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 223, "trial_id": "ea782_00000", "date": "2024-07-15_19-15-45", "timestamp": 1721063745, "time_this_iter_s": 18.634187936782837, "time_total_s": 3826.832999229431, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3826.832999229431, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 8.746153846153845, "ram_util_percent": 78.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05813618309682668}, "default_policy": {"total_loss": 0.05813618309682668, "policy_loss": -0.0017664538051531927, "vf_loss": 4.413377186065035, "vf_loss_unclipped": 9.016643057436323, "vf_explained_var": -9.544368491752315e-07, "entropy": 1.1843457487600444, "mean_kl_loss": 0.006828695931656498, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.0226787801248, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 19103.688, "sample_time_ms": 10910.585, "synch_weights_time_ms": 2.431}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 224, "trial_id": "ea782_00000", "date": "2024-07-15_19-16-03", "timestamp": 1721063763, "time_this_iter_s": 18.518974781036377, "time_total_s": 3845.3519740104675, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3845.3519740104675, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 8.655555555555555, "ram_util_percent": 78.95185185185186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.057767505308231916}, "default_policy": {"total_loss": 0.057767505308231916, "policy_loss": -0.0006967450061173582, "vf_loss": 3.538342219680103, "vf_loss_unclipped": 5.972028540522813, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.1337108802693738, "mean_kl_loss": 0.009995137734439418, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.17233242111854, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 900000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 18949.368, "sample_time_ms": 10784.177, "synch_weights_time_ms": 2.462}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 225, "trial_id": "ea782_00000", "date": "2024-07-15_19-16-22", "timestamp": 1721063782, "time_this_iter_s": 18.50615668296814, "time_total_s": 3863.8581306934357, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3863.8581306934357, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 8.738461538461538, "ram_util_percent": 78.92307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.042013512776374246}, "default_policy": {"total_loss": 0.042013512776374246, "policy_loss": -0.0025609480073131414, "vf_loss": 3.035153833533655, "vf_loss_unclipped": 4.868303587187582, "vf_explained_var": -9.54182671585571e-07, "entropy": 1.1149900259493766, "mean_kl_loss": 0.0061592270446661265, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.46799941971258, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 904000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 18808.204, "sample_time_ms": 10696.532, "synch_weights_time_ms": 2.46}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 226, "trial_id": "ea782_00000", "date": "2024-07-15_19-16-40", "timestamp": 1721063800, "time_this_iter_s": 18.395910263061523, "time_total_s": 3882.254040956497, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3882.254040956497, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 9.107692307692307, "ram_util_percent": 78.9346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04844559581259261}, "default_policy": {"total_loss": 0.04844559581259261, "policy_loss": 0.001296165000115122, "vf_loss": 2.3187405466715663, "vf_loss_unclipped": 2.5046257815444903, "vf_explained_var": -9.545639379700618e-07, "entropy": 1.0582210192802364, "mean_kl_loss": 0.010376739297940859, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.309206008911133}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10302.36, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456800466287724, "mean_inference_ms": 1.1396782269588608, "mean_action_processing_ms": 0.11910703065049276, "mean_env_wait_ms": 0.9509169263538049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006495475769042969, "StateBufferConnector_ms": 0.0037298202514648438, "ViewRequirementAgentConnector_ms": 0.3019733428955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.637647558125, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 908000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 18684.033, "sample_time_ms": 10619.898, "synch_weights_time_ms": 2.46}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 227, "trial_id": "ea782_00000", "date": "2024-07-15_19-16-59", "timestamp": 1721063819, "time_this_iter_s": 18.551651000976562, "time_total_s": 3900.8056919574738, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3900.8056919574738, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 8.565384615384616, "ram_util_percent": 78.68846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.058004705419541516}, "default_policy": {"total_loss": 0.058004705419541516, "policy_loss": -0.0022635082575256254, "vf_loss": 4.9413565720068116, "vf_loss_unclipped": 7.959239750401552, "vf_explained_var": -9.572328026614973e-07, "entropy": 1.144498018186484, "mean_kl_loss": 0.004700596294662943, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1546030044555664}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.44119442961627, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 912000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 18593.388, "sample_time_ms": 10574.873, "synch_weights_time_ms": 2.423}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 228, "trial_id": "ea782_00000", "date": "2024-07-15_19-17-18", "timestamp": 1721063838, "time_this_iter_s": 18.65554451942444, "time_total_s": 3919.461236476898, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3919.461236476898, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 8.437037037037037, "ram_util_percent": 78.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.059287968950508946}, "default_policy": {"total_loss": 0.059287968950508946, "policy_loss": 0.012139919314231636, "vf_loss": 2.4967007510570576, "vf_loss_unclipped": 2.9668863835746544, "vf_explained_var": -9.527846948424382e-07, "entropy": 1.2096582640335758, "mean_kl_loss": 0.019210970750594112, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1546030044555664}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.19232360726403, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 916000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 18535.92, "sample_time_ms": 10523.405, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 229, "trial_id": "ea782_00000", "date": "2024-07-15_19-17-36", "timestamp": 1721063856, "time_this_iter_s": 18.334969758987427, "time_total_s": 3937.7962062358856, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3937.7962062358856, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 8.534615384615385, "ram_util_percent": 78.99615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04746243375058629}, "default_policy": {"total_loss": 0.04746243375058629, "policy_loss": 0.004772973637571181, "vf_loss": 2.704494969867694, "vf_loss_unclipped": 3.2429729832896292, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.2942923803065123, "mean_kl_loss": 0.013549691372961704, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1546030044555664}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.8542366389678, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 920000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 18523.025, "sample_time_ms": 10507.699, "synch_weights_time_ms": 2.326}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 230, "trial_id": "ea782_00000", "date": "2024-07-15_19-17-54", "timestamp": 1721063874, "time_this_iter_s": 18.44790482521057, "time_total_s": 3956.244111061096, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3956.244111061096, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 8.423076923076923, "ram_util_percent": 79.00384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06124927180467733}, "default_policy": {"total_loss": 0.06124927180467733, "policy_loss": 0.010031783685231133, "vf_loss": 2.9494778167273696, "vf_loss_unclipped": 3.7994506354969957, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.2412422470954945, "mean_kl_loss": 0.01881401028252501, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1546030044555664}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.52543595848556, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 924000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 18536.789, "sample_time_ms": 10508.488, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 231, "trial_id": "ea782_00000", "date": "2024-07-15_19-18-13", "timestamp": 1721063893, "time_this_iter_s": 18.735309600830078, "time_total_s": 3974.9794206619263, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3974.9794206619263, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 79.0037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07247840631693633}, "default_policy": {"total_loss": 0.07247840631693633, "policy_loss": 0.0001153176998409794, "vf_loss": 5.951789529720095, "vf_loss_unclipped": 12.597054449352882, "vf_explained_var": -9.550722931493829e-07, "entropy": 1.1863960184649365, "mean_kl_loss": 0.011125202541012935, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1546030044555664}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.07845429390105, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 928000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 18553.218, "sample_time_ms": 10517.644, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 232, "trial_id": "ea782_00000", "date": "2024-07-15_19-18-32", "timestamp": 1721063912, "time_this_iter_s": 18.774827241897583, "time_total_s": 3993.754247903824, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3993.754247903824, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 8.614814814814814, "ram_util_percent": 79.01851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.117540331766891}, "default_policy": {"total_loss": 0.117540331766891, "policy_loss": 0.01397866703051605, "vf_loss": 5.349456822694237, "vf_loss_unclipped": 12.959820120954818, "vf_explained_var": -9.573598914563274e-07, "entropy": 1.2263715743764376, "mean_kl_loss": 0.04336304220812377, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.56260642759145, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 932000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 18537.032, "sample_time_ms": 10500.828, "synch_weights_time_ms": 2.255}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 233, "trial_id": "ea782_00000", "date": "2024-07-15_19-18-51", "timestamp": 1721063931, "time_this_iter_s": 18.47278094291687, "time_total_s": 4012.2270288467407, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4012.2270288467407, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 8.561538461538461, "ram_util_percent": 78.65384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07074879424900675}, "default_policy": {"total_loss": 0.07074879424900675, "policy_loss": 0.0025792410190123866, "vf_loss": 4.35434754291323, "vf_loss_unclipped": 7.730734162747479, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.3817784699803985, "mean_kl_loss": 0.014219074759623413, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.96754777540025, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 936000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 18546.12, "sample_time_ms": 10507.116, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 234, "trial_id": "ea782_00000", "date": "2024-07-15_19-19-09", "timestamp": 1721063949, "time_this_iter_s": 18.60948944091797, "time_total_s": 4030.8365182876587, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4030.8365182876587, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 8.492592592592594, "ram_util_percent": 78.62592592592591}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06189124732425234}, "default_policy": {"total_loss": 0.06189124732425234, "policy_loss": -0.0011043582987318287, "vf_loss": 3.8995229765804593, "vf_loss_unclipped": 5.735025989602624, "vf_explained_var": -9.544368491752315e-07, "entropy": 1.3458307698083076, "mean_kl_loss": 0.01385779555252843, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.61551218011004, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 940000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 18568.268, "sample_time_ms": 10517.654, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 235, "trial_id": "ea782_00000", "date": "2024-07-15_19-19-28", "timestamp": 1721063968, "time_this_iter_s": 18.727200269699097, "time_total_s": 4049.563718557358, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4049.563718557358, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 8.688461538461537, "ram_util_percent": 78.73461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.049383163826418115}, "default_policy": {"total_loss": 0.049383163826418115, "policy_loss": 0.005531302763959333, "vf_loss": 2.931089019533922, "vf_loss_unclipped": 3.479016046343582, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.2923939000568918, "mean_kl_loss": 0.008395945159609177, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10308.923076923076, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567859153912357, "mean_inference_ms": 1.1394146975782464, "mean_action_processing_ms": 0.11907570100058375, "mean_env_wait_ms": 0.9508145219607212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006429048684927134, "StateBufferConnector_ms": 0.003716578850379357, "ViewRequirementAgentConnector_ms": 0.30212035545936}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.46627148294314, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 944000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 18568.282, "sample_time_ms": 10511.568, "synch_weights_time_ms": 2.233}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 236, "trial_id": "ea782_00000", "date": "2024-07-15_19-19-46", "timestamp": 1721063986, "time_this_iter_s": 18.39666509628296, "time_total_s": 4067.9603836536407, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4067.9603836536407, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 8.762962962962963, "ram_util_percent": 78.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0454943052925932}, "default_policy": {"total_loss": 0.0454943052925932, "policy_loss": -0.0013727963582348469, "vf_loss": 3.7028745438244295, "vf_loss_unclipped": 5.447172411596343, "vf_explained_var": -9.559619147131947e-07, "entropy": 1.3373430279780552, "mean_kl_loss": 0.005680658847675442, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.31774045046768, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 948000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 18579.707, "sample_time_ms": 10526.104, "synch_weights_time_ms": 2.226}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 237, "trial_id": "ea782_00000", "date": "2024-07-15_19-20-05", "timestamp": 1721064005, "time_this_iter_s": 18.66649079322815, "time_total_s": 4086.626874446869, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4086.626874446869, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 8.646153846153847, "ram_util_percent": 78.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05448024065049091}, "default_policy": {"total_loss": 0.05448024065049091, "policy_loss": 0.005871617149855537, "vf_loss": 3.1636341558590626, "vf_loss_unclipped": 3.9710256292113364, "vf_explained_var": -9.543097603804014e-07, "entropy": 1.3353772160213893, "mean_kl_loss": 0.00979978081596549, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.02719693106553, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 952000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 18574.624, "sample_time_ms": 10517.14, "synch_weights_time_ms": 2.205}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 238, "trial_id": "ea782_00000", "date": "2024-07-15_19-20-24", "timestamp": 1721064024, "time_this_iter_s": 18.604706287384033, "time_total_s": 4105.231580734253, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4105.231580734253, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 8.374074074074073, "ram_util_percent": 78.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.04579622657604214}, "default_policy": {"total_loss": 0.04579622657604214, "policy_loss": 0.002809466015714318, "vf_loss": 2.827193318971439, "vf_loss_unclipped": 3.6261991169025647, "vf_explained_var": -9.539284939959104e-07, "entropy": 1.252720921405597, "mean_kl_loss": 0.008496329617550794, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 215.71695532854716, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 956000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 18595.661, "sample_time_ms": 10524.087, "synch_weights_time_ms": 2.228}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 239, "trial_id": "ea782_00000", "date": "2024-07-15_19-20-42", "timestamp": 1721064042, "time_this_iter_s": 18.54526686668396, "time_total_s": 4123.776847600937, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4123.776847600937, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 8.53846153846154, "ram_util_percent": 78.83846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05137415933234097}, "default_policy": {"total_loss": 0.05137415933234097, "policy_loss": 0.00010367223361471314, "vf_loss": 3.4169267377873727, "vf_loss_unclipped": 4.715916228446879, "vf_explained_var": -9.5367431640625e-07, "entropy": 1.22876364208742, "mean_kl_loss": 0.009874229649650746, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.04893653382462, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 960000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 18602.536, "sample_time_ms": 10534.707, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 240, "trial_id": "ea782_00000", "date": "2024-07-15_19-21-01", "timestamp": 1721064061, "time_this_iter_s": 18.516571521759033, "time_total_s": 4142.293419122696, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4142.293419122696, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 8.55, "ram_util_percent": 78.88846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07057706382783896}, "default_policy": {"total_loss": 0.07057706382783896, "policy_loss": 0.0005170243428841328, "vf_loss": 4.733334628185992, "vf_loss_unclipped": 9.296707120594947, "vf_explained_var": -9.595204009684418e-07, "entropy": 1.125772599154698, "mean_kl_loss": 0.013122373818091478, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.67085163927914, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 964000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 18575.34, "sample_time_ms": 10516.495, "synch_weights_time_ms": 2.208}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 241, "trial_id": "ea782_00000", "date": "2024-07-15_19-21-19", "timestamp": 1721064079, "time_this_iter_s": 18.46350908279419, "time_total_s": 4160.75692820549, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4160.75692820549, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 8.511111111111111, "ram_util_percent": 78.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05224828604561116}, "default_policy": {"total_loss": 0.05224828604561116, "policy_loss": 0.001491762855564798, "vf_loss": 3.5229812579622655, "vf_loss_unclipped": 5.4893067161411615, "vf_explained_var": -9.54182671585571e-07, "entropy": 1.186923432197652, "mean_kl_loss": 0.008965109535522743, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 217.5511814431815, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 968000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 18536.744, "sample_time_ms": 10458.215, "synch_weights_time_ms": 2.214}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 242, "trial_id": "ea782_00000", "date": "2024-07-15_19-21-38", "timestamp": 1721064098, "time_this_iter_s": 18.388818979263306, "time_total_s": 4179.145747184753, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4179.145747184753, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 8.719230769230768, "ram_util_percent": 78.98076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.0414087541872012}, "default_policy": {"total_loss": 0.0414087541872012, "policy_loss": 0.0024727703487155027, "vf_loss": 2.278935705103091, "vf_loss_unclipped": 2.511184263902941, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.2306400927653445, "mean_kl_loss": 0.00932304971580507, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.39294285621824, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 972000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 18538.192, "sample_time_ms": 10451.993, "synch_weights_time_ms": 2.243}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 243, "trial_id": "ea782_00000", "date": "2024-07-15_19-21-56", "timestamp": 1721064116, "time_this_iter_s": 18.487048387527466, "time_total_s": 4197.632795572281, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4197.632795572281, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 8.419230769230769, "ram_util_percent": 79.09615384615383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.05111630421294682}, "default_policy": {"total_loss": 0.05111630421294682, "policy_loss": 0.0041430412242109615, "vf_loss": 2.9733063812449037, "vf_loss_unclipped": 5.548371252474754, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.215499796148048, "mean_kl_loss": 0.009954476836421686, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.37786535519174, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 976000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 18500.785, "sample_time_ms": 10417.84, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 244, "trial_id": "ea782_00000", "date": "2024-07-15_19-22-14", "timestamp": 1721064134, "time_this_iter_s": 18.235660552978516, "time_total_s": 4215.868456125259, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4215.868456125259, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 8.311538461538461, "ram_util_percent": 79.18846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08653458696541819}, "default_policy": {"total_loss": 0.08653458696541819, "policy_loss": 0.0020873177710221584, "vf_loss": 6.76367626922217, "vf_loss_unclipped": 20.254726932247056, "vf_explained_var": -9.559619147131947e-07, "entropy": 1.261999269284165, "mean_kl_loss": 0.009706368083982276, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10341.592592592593, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567641235464284, "mean_inference_ms": 1.139129675934888, "mean_action_processing_ms": 0.11904175628321294, "mean_env_wait_ms": 0.9507188597199027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671369058114511, "StateBufferConnector_ms": 0.0037052013255931713, "ViewRequirementAgentConnector_ms": 0.3010626192446108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 213.37256309369116, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 980000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 18502.917, "sample_time_ms": 10410.083, "synch_weights_time_ms": 2.259}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 27, "training_iteration": 245, "trial_id": "ea782_00000", "date": "2024-07-15_19-22-33", "timestamp": 1721064153, "time_this_iter_s": 18.748406171798706, "time_total_s": 4234.616862297058, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4234.616862297058, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 8.807407407407407, "ram_util_percent": 79.16296296296296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.08025182399457928}, "default_policy": {"total_loss": 0.08025182399457928, "policy_loss": 0.0008642290103763565, "vf_loss": 5.990320186879335, "vf_loss_unclipped": 18.40199192487863, "vf_explained_var": -9.604100225322536e-07, "entropy": 1.249147439943448, "mean_kl_loss": 0.011250271659378813, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 214.43227584319163, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 984000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 18528.941, "sample_time_ms": 10463.16, "synch_weights_time_ms": 2.292}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 246, "trial_id": "ea782_00000", "date": "2024-07-15_19-22-52", "timestamp": 1721064172, "time_this_iter_s": 18.656360387802124, "time_total_s": 4253.27322268486, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4253.27322268486, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 8.562962962962963, "ram_util_percent": 79.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.07044906578541024}, "default_policy": {"total_loss": 0.07044906578541024, "policy_loss": -0.0001902619043170516, "vf_loss": 5.764800366943579, "vf_loss_unclipped": 11.746749753001403, "vf_explained_var": -9.565973586873459e-07, "entropy": 1.320261917770036, "mean_kl_loss": 0.007501177757432106, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.09768879530927, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 988000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 18488.224, "sample_time_ms": 10450.459, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 247, "trial_id": "ea782_00000", "date": "2024-07-15_19-23-10", "timestamp": 1721064190, "time_this_iter_s": 18.259462594985962, "time_total_s": 4271.532685279846, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4271.532685279846, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 8.692307692307692, "ram_util_percent": 79.26538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.06229360134595}, "default_policy": {"total_loss": 0.06229360134595, "policy_loss": 0.003164211540286348, "vf_loss": 4.434193672592452, "vf_loss_unclipped": 7.1249699496638295, "vf_explained_var": -9.564702698925156e-07, "entropy": 1.316446046076858, "mean_kl_loss": 0.008538263114825162, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 218.77490110300798, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 992000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 18456.357, "sample_time_ms": 10442.342, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 248, "trial_id": "ea782_00000", "date": "2024-07-15_19-23-28", "timestamp": 1721064208, "time_this_iter_s": 18.286295890808105, "time_total_s": 4289.818981170654, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4289.818981170654, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 8.75, "ram_util_percent": 79.30384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.038566363605061}, "default_policy": {"total_loss": 0.038566363605061, "policy_loss": -0.00013318052167879112, "vf_loss": 2.7175834069628197, "vf_loss_unclipped": 3.085122366576815, "vf_explained_var": -9.545639379700618e-07, "entropy": 1.3885814894491166, "mean_kl_loss": 0.006653781591667832, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 219.56740634553805, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 996000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 18423.839, "sample_time_ms": 10449.063, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 249, "trial_id": "ea782_00000", "date": "2024-07-15_19-23-47", "timestamp": 1721064227, "time_this_iter_s": 18.219619512557983, "time_total_s": 4308.038600683212, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4308.038600683212, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 8.415384615384616, "ram_util_percent": 79.32692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.060775580363092954}, "default_policy": {"total_loss": 0.060775580363092954, "policy_loss": 0.0009833300949882533, "vf_loss": 3.9683803115953515, "vf_loss_unclipped": 7.493000203167706, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.4289930240431827, "mean_kl_loss": 0.011610600952617402, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.7319045066833496}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}}, "episode_reward_max": -8905.0, "episode_reward_min": -12516.0, "episode_reward_mean": -10364.214285714286, "episode_len_mean": 35040.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10756.0, -11984.0, -11010.0, -11765.0, -11559.0, -10152.0, -9373.0, -9362.0, -9158.0, -9068.0, -8905.0, -9323.0, -9540.0, -9809.0, -8991.0, -9196.0, -9755.0, -10047.0, -11307.0, -12516.0, -10377.0, -10664.0, -10146.0, -10724.0, -12072.0, -10473.0, -11191.0, -10975.0], "episode_lengths": [35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.456737546817601, "mean_inference_ms": 1.1388277352356442, "mean_action_processing_ms": 0.11900571344990027, "mean_env_wait_ms": 0.9506038393818305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006651878356933594, "StateBufferConnector_ms": 0.003694636481148856, "ViewRequirementAgentConnector_ms": 0.30175277165004183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 216.43822022963957, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 18420.51, "sample_time_ms": 10460.249, "synch_weights_time_ms": 2.321}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 28, "training_iteration": 250, "trial_id": "ea782_00000", "date": "2024-07-15_19-24-05", "timestamp": 1721064245, "time_this_iter_s": 18.483298301696777, "time_total_s": 4326.521898984909, "pid": 45714, "hostname": "LAPTOP-R6OO6DVP", "node_ip": "172.23.43.95", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "BBrightEnv", "env_config": {"env": "BBrightEnv", "csv": false, "verbose": false, "output": "/tmp/tmp3c3zyiyl", "timesteps": 1000000.0, "num_workers": 1, "num_gpus": 0, "alg": "PPO", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc098424430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4326.521898984909, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 8.86153846153846, "ram_util_percent": 79.38076923076923}}
